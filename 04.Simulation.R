####################################
##Simulate evolution over networks## 
####################################
####################################
##1. Packages, data, and functions##
####################################
####Working directory
setwd("/Users/Chimera/Documents/ThorntonLab/Epistasis/2020")

####Packages
library(data.table)
library(Matrix)
library(ordinalNet)
library(Hmisc)
library(ggplot2)
library(boot)
library(gtools)
library(gplots)
library(glmnetcr)
library(dotCall64)
library(gridExtra)
library(grid)
library(seqinr)
library(stringr)
library(vioplot)
library(rgexf)
library(igraph)
library(nloptr)
library(pROC)
library(MatrixModels)
library(moments)
library(ppcor)

####Custom functions
source("Functions.R")

####Data
load("TG.ACT.NET.rda")
load("DT.JOINT.APPEND.rda")

##Amino acid states
AAs <- c("A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y")

##Split S into two groups (S and Z) for analyses that take account of the genetic code
AAs.extend <- c("A","C","D","E","F","G","H","I","K","L","M","N","P","Q","R","S","T","V","W","Y","Z")

##Neighbor and distance matrices
AA.NEIGHBORS.S <- read.table(file="AA.neighbors.S.txt",header=T,row.names=1,quote="")
AA.DISTANCES.S <- read.table(file="AA.distance.S.txt", header=T,row.names=1,quote="")
AA.NEIGHBORS.Z <- read.table(file="AA.neighbors.Z.txt",header=T,row.names=1,quote="")
AA.DISTANCES.Z <- read.table(file="AA.distance.Z.txt", header=T,row.names=1,quote="")
AA.NEIGHBORS.N <- read.table(file="AA.neighbors.N.txt",header=T,row.names=1,quote="")
AA.DISTANCES.N <- read.table(file="AA.distance.N.txt", header=T,row.names=1,quote="")

##Lists of genotypes in different models and networks
TG.ERE.LIST <- unique(substr(DT.JOINT[TE.JOINT.CLASS == 'ERE-specific',]$AAseq,2,5))
TG.SRE.LIST <- unique(substr(DT.JOINT[TE.JOINT.CLASS == 'SRE-specific',]$AAseq,2,5))
TH.ERE.LIST <- TG.ERE.LIST[-grep("Z",TG.ERE.LIST)]
TH.SRE.LIST <- TG.SRE.LIST[-grep("Z",TG.SRE.LIST)]
PG.ERE.LIST <- unique(substr(DT.JOINT[PE.JOINT.CLASS == 'ERE-specific',]$AAseq,2,5))
PG.SRE.LIST <- unique(substr(DT.JOINT[PE.JOINT.CLASS == 'SRE-specific',]$AAseq,2,5))
PH.ERE.LIST <- PG.ERE.LIST[-grep("Z",PG.ERE.LIST)]
PH.SRE.LIST <- PG.SRE.LIST[-grep("Z",PG.SRE.LIST)]
MG.ERE.LIST <- unique(substr(DT.JOINT[ME.JOINT.CLASS == 'ERE-specific',]$AAseq,2,5))
MG.SRE.LIST <- unique(substr(DT.JOINT[ME.JOINT.CLASS == 'SRE-specific',]$AAseq,2,5))
MH.ERE.LIST <- MG.ERE.LIST[-grep("Z",MG.ERE.LIST)]
MH.SRE.LIST <- MG.SRE.LIST[-grep("Z",MG.SRE.LIST)]

#Overlap of ERE genotypes in multiple models
TG.ERE.INTERSECT <- which(TG.ERE.LIST %in% PG.ERE.LIST & TG.ERE.LIST %in% MG.ERE.LIST)
PG.ERE.INTERSECT <- which(PG.ERE.LIST %in% TG.ERE.LIST & PG.ERE.LIST %in% MG.ERE.LIST)
MG.ERE.INTERSECT <- which(MG.ERE.LIST %in% PG.ERE.LIST & MG.ERE.LIST %in% TG.ERE.LIST)
TH.ERE.INTERSECT <- which(TH.ERE.LIST %in% PH.ERE.LIST & TH.ERE.LIST %in% MH.ERE.LIST)
PH.ERE.INTERSECT <- which(PH.ERE.LIST %in% TH.ERE.LIST & PH.ERE.LIST %in% MH.ERE.LIST)
MH.ERE.INTERSECT <- which(MH.ERE.LIST %in% PH.ERE.LIST & MH.ERE.LIST %in% TH.ERE.LIST)

#Networks
load("TG.ACT.NET.rda")
load("PG.ACT.NET.rda")
load("MG.ACT.NET.rda")
load("TH.ACT.NET.rda")
load("PH.ACT.NET.rda")
load("MH.ACT.NET.rda")

#################
###2. Simulate###
#################
##Simulation uses a Maynard Smith word game like model
##A genotype is in a network if it is functional, i.e. an activator on ERE, SRE, or both for a given model
##Functional genotypes are connected either via genetic code (G) or via hamming distance (H)
##Any step to a connected genotype is allowed with equal probability
##Paths are started from an ERE-specific genotype
##Paths end when the first SRE-specific genotype is encountered

###Simulations for all ERE-specific starting genotypes
#TG.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(TG.ERE.LIST,TG.ACT.NET,"T",100); save(TG.ALL_ERE.ALL_GENO.SIMULATE, file="TG.ALL_ERE.ALL_GENO.SIMULATE.rda")
#PG.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(PG.ERE.LIST,PG.ACT.NET,"P",100); save(PG.ALL_ERE.ALL_GENO.SIMULATE, file="PG.ALL_ERE.ALL_GENO.SIMULATE.rda")
#MG.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(MG.ERE.LIST,MG.ACT.NET,"M",100); save(MG.ALL_ERE.ALL_GENO.SIMULATE, file="MG.ALL_ERE.ALL_GENO.SIMULATE.rda")
#TH.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(TH.ERE.LIST,TH.ACT.NET,"T",100); save(TH.ALL_ERE.ALL_GENO.SIMULATE, file="TH.ALL_ERE.ALL_GENO.SIMULATE.rda")
#PH.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(PH.ERE.LIST,PH.ACT.NET,"P",100); save(PH.ALL_ERE.ALL_GENO.SIMULATE, file="PH.ALL_ERE.ALL_GENO.SIMULATE.rda")
#MH.ALL_ERE.ALL_GENO.SIMULATE <- ms.simulate(MH.ERE.LIST,MH.ACT.NET,"M",100); save(MH.ALL_ERE.ALL_GENO.SIMULATE, file="MH.ALL_ERE.ALL_GENO.SIMULATE.rda")

load("TG.ALL_ERE.ALL_GENO.SIMULATE.rda")
load("PG.ALL_ERE.ALL_GENO.SIMULATE.rda")
load("MG.ALL_ERE.ALL_GENO.SIMULATE.rda")
load("TH.ALL_ERE.ALL_GENO.SIMULATE.rda")
load("PH.ALL_ERE.ALL_GENO.SIMULATE.rda")
load("MH.ALL_ERE.ALL_GENO.SIMULATE.rda")

###Additional simulations for subset of ERE-specific genotypes found in all three models
#TG.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(TG.ERE.LIST[TG.ERE.INTERSECT],TG.ACT.NET,"T",1000); save(TG.INT_ERE.ALL_GENO.SIMULATE, file="TG.INT_ERE.ALL_GENO.SIMULATE.rda")
#PG.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(PG.ERE.LIST[PG.ERE.INTERSECT],PG.ACT.NET,"P",1000); save(PG.INT_ERE.ALL_GENO.SIMULATE, file="PG.INT_ERE.ALL_GENO.SIMULATE.rda")
#MG.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(MG.ERE.LIST[MG.ERE.INTERSECT],MG.ACT.NET,"M",1000); save(MG.INT_ERE.ALL_GENO.SIMULATE, file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#TH.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(TH.ERE.LIST[TH.ERE.INTERSECT],TH.ACT.NET,"T",1000); save(TH.INT_ERE.ALL_GENO.SIMULATE, file="TH.INT_ERE.ALL_GENO.SIMULATE.rda")
#PH.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(PH.ERE.LIST[PH.ERE.INTERSECT],PH.ACT.NET,"P",1000); save(PH.INT_ERE.ALL_GENO.SIMULATE, file="PH.INT_ERE.ALL_GENO.SIMULATE.rda")
#MH.INT_ERE.ALL_GENO.SIMULATE <- ms.simulate(MH.ERE.LIST[MH.ERE.INTERSECT],MH.ACT.NET,"M",1000); save(MH.INT_ERE.ALL_GENO.SIMULATE, file="MH.INT_ERE.ALL_GENO.SIMULATE.rda")

load("TG.INT_ERE.ALL_GENO.SIMULATE.rda")
load("PG.INT_ERE.ALL_GENO.SIMULATE.rda")
load("MG.INT_ERE.ALL_GENO.SIMULATE.rda")
load("TH.INT_ERE.ALL_GENO.SIMULATE.rda")
load("PH.INT_ERE.ALL_GENO.SIMULATE.rda")
load("MH.INT_ERE.ALL_GENO.SIMULATE.rda")

###Simulations for all ERE-specific starting genotypes under selection for increased SRE specificity
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1     <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=1,CUTOFF=200);    save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1    , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3     <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=3,CUTOFF=200);    save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3    , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5     <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=5,CUTOFF=200);    save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5    , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10    <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=10,CUTOFF=200);   save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10   , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17    <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=17,CUTOFF=200);   save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17   , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31    <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=31,CUTOFF=200);   save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31   , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56    <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=56,CUTOFF=200);   save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56   , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100   <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=100,CUTOFF=200);  save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100  , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177   <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=177,CUTOFF=200);  save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177  , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316   <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=316,CUTOFF=200);  save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316  , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562   <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=562,CUTOFF=200);  save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562  , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000  <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=1000,CUTOFF=200); save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000 , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778  <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=1778,CUTOFF=200); save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778 , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162  <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=3162,CUTOFF=200); save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162 , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263  <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=5263,CUTOFF=200); save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263 , file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000 <- sel.simulate(MG.ERE.LIST,MG.ACT.NET,"P",REPS=100,POP.SIZE=10000,CUTOFF=200);save(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000, file="MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
load("MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1     <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=1,CUTOFF=200);    save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1    , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3     <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=3,CUTOFF=200);    save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3    , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5     <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=5,CUTOFF=200);    save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5    , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10    <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=10,CUTOFF=200);   save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10   , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17    <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=17,CUTOFF=200);   save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17   , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31    <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=31,CUTOFF=200);   save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31   , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56    <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=56,CUTOFF=200);   save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56   , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100   <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=100,CUTOFF=200);  save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100  , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177   <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=177,CUTOFF=200);  save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177  , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316   <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=316,CUTOFF=200);  save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316  , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562   <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=562,CUTOFF=200);  save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562  , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000  <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=1000,CUTOFF=200); save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000 , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778  <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=1778,CUTOFF=200); save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778 , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162  <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=3162,CUTOFF=200); save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162 , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263  <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=5263,CUTOFF=200); save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263 , file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000 <- sel.simulate(PG.ERE.LIST,PG.ACT.NET,"P",REPS=100,POP.SIZE=10000,CUTOFF=200);save(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000, file="PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
load("PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1     <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=1,CUTOFF=200);    save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1    , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3     <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=3,CUTOFF=200);    save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3    , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5     <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=5,CUTOFF=200);    save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5    , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10    <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=10,CUTOFF=200);   save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10   , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17    <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=17,CUTOFF=200);   save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17   , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31    <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=31,CUTOFF=200);   save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31   , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56    <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=56,CUTOFF=200);   save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56   , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100   <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=100,CUTOFF=200);  save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100  , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177   <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=177,CUTOFF=200);  save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177  , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316   <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=316,CUTOFF=200);  save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316  , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562   <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=562,CUTOFF=200);  save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562  , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000  <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=1000,CUTOFF=200); save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000 , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778  <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=1778,CUTOFF=200); save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778 , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162  <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=3162,CUTOFF=200); save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162 , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263  <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=5263,CUTOFF=200); save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263 , file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000 <- sel.simulate(TG.ERE.LIST,TG.ACT.NET,"T",REPS=100,POP.SIZE=10000,CUTOFF=200);save(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000, file="TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263.rda")
load("TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000.rda")

#####################
###3. Path Lengths###
#####################
##Set unconnected nodes to NA
TG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
TH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
PH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
MH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA

TG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
PG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
MG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
TH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
PH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA
MH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps==0)] <- NA

MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps==0)] <- NA 
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps==0)] <- NA
MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps==0)] <- NA

PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps==0)] <- NA 
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps==0)] <- NA
PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps==0)] <- NA

TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps==0)] <- NA 
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps==0)] <- NA
TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps==0)] <- NA

##Set steps greater than 20 to NA to remove high local peaks
#TG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#TH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#PH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#MH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#
#TG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#PG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#MG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#TH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(TH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#PH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(PH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#MH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps[which(MH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps > 20)] <- NA
#
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps > 20)] <- NA 
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps > 20)] <- NA
#MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps > 20)] <- NA
#
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps > 20)] <- NA 
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps > 20)] <- NA
#PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps > 20)] <- NA
#
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps > 20)] <- NA 
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps > 20)] <- NA
#TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps[which(TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps > 20)] <- NA

##Extract path lengths
TG.ALL_ERE.ALL_GENO.STEPS.N <- TG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps
PG.ALL_ERE.ALL_GENO.STEPS.N <- PG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps
MG.ALL_ERE.ALL_GENO.STEPS.N <- MG.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps
TH.ALL_ERE.ALL_GENO.STEPS.N <- TH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps
PH.ALL_ERE.ALL_GENO.STEPS.N <- PH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps
MH.ALL_ERE.ALL_GENO.STEPS.N <- MH.ALL_ERE.ALL_GENO.SIMULATE$Number.Steps

TG.INT_ERE.ALL_GENO.STEPS.N <- TG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps
PG.INT_ERE.ALL_GENO.STEPS.N <- PG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps
MG.INT_ERE.ALL_GENO.STEPS.N <- MG.INT_ERE.ALL_GENO.SIMULATE$Number.Steps
TH.INT_ERE.ALL_GENO.STEPS.N <- TH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps
PH.INT_ERE.ALL_GENO.STEPS.N <- PH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps
MH.INT_ERE.ALL_GENO.STEPS.N <- MH.INT_ERE.ALL_GENO.SIMULATE$Number.Steps

MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N     <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N     <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N     <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N    <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N    <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N    <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N    <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N   <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N   <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N   <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N   <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N  <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N  <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N  <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N  <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps
MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N <- MG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps

PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N     <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N     <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N     <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N    <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N    <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N    <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N    <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N   <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N   <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N   <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N   <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N  <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N  <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N  <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N  <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps
PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N <- PG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps

TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N     <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N     <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N     <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N    <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N    <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N17$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N    <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N31$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N    <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N56$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N   <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N100$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N   <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N177$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N   <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N316$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N   <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N562$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N  <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1000$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N  <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N1778$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N  <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N3162$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N  <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N5263$Number.Steps
TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N <- TG.ALL_ERE.ALL_GENO.SEL.SIMULATE.N10000$Number.Steps

##Path length for each model/network combination averaged across starting genotypes
#Mean for all starting genotypes
TG.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(TG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(PG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(MG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
TH.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(TH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PH.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(PH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MH.ALL_ERE.ALL_GENO.STEPS.AVG <- mean(MH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)

MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

#SD for all starting genotypes
TG.ALL_ERE.ALL_GENO.STEPS.SD <- sd(TG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.STEPS.SD <- sd(PG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.STEPS.SD <- sd(MG.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
TH.ALL_ERE.ALL_GENO.STEPS.SD <- sd(TH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PH.ALL_ERE.ALL_GENO.STEPS.SD <- sd(PH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MH.ALL_ERE.ALL_GENO.STEPS.SD <- sd(MH.ALL_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)

MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N,na.rm=TRUE)
TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N,na.rm=TRUE)

#Mean for common starting genotypes
TG.INT_ERE.ALL_GENO.STEPS.AVG <- mean(TG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PG.INT_ERE.ALL_GENO.STEPS.AVG <- mean(PG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MG.INT_ERE.ALL_GENO.STEPS.AVG <- mean(MG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
TH.INT_ERE.ALL_GENO.STEPS.AVG <- mean(TH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PH.INT_ERE.ALL_GENO.STEPS.AVG <- mean(PH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MH.INT_ERE.ALL_GENO.STEPS.AVG <- mean(MH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)

MG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)

PG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)

TG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG     <- mean(TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG    <- mean(TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG   <- mean(TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG  <- mean(TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG <- mean(TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)

#SD for common starting genotypes
TG.INT_ERE.ALL_GENO.STEPS.SD <- sd(TG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PG.INT_ERE.ALL_GENO.STEPS.SD <- sd(PG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MG.INT_ERE.ALL_GENO.STEPS.SD <- sd(MG.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
TH.INT_ERE.ALL_GENO.STEPS.SD <- sd(TH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
PH.INT_ERE.ALL_GENO.STEPS.SD <- sd(PH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)
MH.INT_ERE.ALL_GENO.STEPS.SD <- sd(MH.INT_ERE.ALL_GENO.STEPS.N,na.rm=TRUE)

MG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)
MG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,MG.ERE.INTERSECT],na.rm=TRUE)

PG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)
PG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,PG.ERE.INTERSECT],na.rm=TRUE)

TG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD     <- sd(TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD    <- sd(TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD   <- sd(TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD  <- sd(TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)
TG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD <- sd(TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.N[,TG.ERE.INTERSECT],na.rm=TRUE)

#Collect means
ALL.ALL_GENO.STEPS.AVG <- c(TG.ALL_ERE.ALL_GENO.STEPS.AVG,TG.INT_ERE.ALL_GENO.STEPS.AVG,
                            PG.ALL_ERE.ALL_GENO.STEPS.AVG,PG.INT_ERE.ALL_GENO.STEPS.AVG,
                            MG.ALL_ERE.ALL_GENO.STEPS.AVG,MG.INT_ERE.ALL_GENO.STEPS.AVG,
                            TH.ALL_ERE.ALL_GENO.STEPS.AVG,TH.INT_ERE.ALL_GENO.STEPS.AVG,
                            PH.ALL_ERE.ALL_GENO.STEPS.AVG,PH.INT_ERE.ALL_GENO.STEPS.AVG,
                            MH.ALL_ERE.ALL_GENO.STEPS.AVG,MH.INT_ERE.ALL_GENO.STEPS.AVG)

MG.ALL_ERE.ALL_GENO.AVG <- c(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)
PG.ALL_ERE.ALL_GENO.AVG <- c(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)
TG.ALL_ERE.ALL_GENO.AVG <- c(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)

MG.INT_ERE.ALL_GENO.AVG <- c(MG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,MG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)
PG.INT_ERE.ALL_GENO.AVG <- c(PG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,PG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)
TG.INT_ERE.ALL_GENO.AVG <- c(TG.INT_ERE.ALL_GENO.SEL.N1.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N3.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N5.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N10.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N17.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N31.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N56.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N100.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N177.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N316.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N562.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.AVG,TG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.AVG)

#Collect SDs
ALL.ALL_GENO.STEPS.SD  <- c(TG.ALL_ERE.ALL_GENO.STEPS.SD,TG.INT_ERE.ALL_GENO.STEPS.SD,
                                    PG.ALL_ERE.ALL_GENO.STEPS.SD,PG.INT_ERE.ALL_GENO.STEPS.SD,
                                    MG.ALL_ERE.ALL_GENO.STEPS.SD,MG.INT_ERE.ALL_GENO.STEPS.SD,
                                    TH.ALL_ERE.ALL_GENO.STEPS.SD,TH.INT_ERE.ALL_GENO.STEPS.SD,
                                    PH.ALL_ERE.ALL_GENO.STEPS.SD,PH.INT_ERE.ALL_GENO.STEPS.SD,
                                    MH.ALL_ERE.ALL_GENO.STEPS.SD,MH.INT_ERE.ALL_GENO.STEPS.SD)

MG.ALL_ERE.ALL_GENO.SD <- c(MG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD,MG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD)
PG.ALL_ERE.ALL_GENO.SD <- c(PG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD,PG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD)
TG.ALL_ERE.ALL_GENO.SD <- c(TG.ALL_ERE.ALL_GENO.SEL.N1.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N3.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N5.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N10.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N17.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N31.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N56.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N100.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N177.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N316.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N562.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N1000.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N1778.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N3162.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N5263.STEPS.SD,TG.ALL_ERE.ALL_GENO.SEL.N10000.STEPS.SD)

MG.INT_ERE.ALL_GENO.SD <- c(MG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD,MG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD)
PG.INT_ERE.ALL_GENO.SD <- c(PG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD,PG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD)
TG.INT_ERE.ALL_GENO.SD <- c(TG.INT_ERE.ALL_GENO.SEL.N1.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N3.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N5.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N10.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N17.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N31.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N56.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N100.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N177.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N316.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N562.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N1000.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N1778.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N3162.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N5263.STEPS.SD,TG.INT_ERE.ALL_GENO.SEL.N10000.STEPS.SD)

##Plot
##pdf("Sim.path.length.no.local.pdf")
par(mfrow=c(1,1))
par(pty="s")
barplot(ALL.ALL_GENO.STEPS.AVG,ylim=c(0,13),space=rep(c(0.5,0),6),width=0.5,cex.names=0.5,cex.axis=0.5,cex.main=0.5,col=c(rep(c("darkred","red"),3),rep(c("darkblue","skyblue2"),3)),main="Negative")
error.bar(x = c(0.5,1,1.75,2.25,3,3.5,4.25,4.75,5.5,6,6.75,7.25), y = ALL.ALL_GENO.STEPS.AVG, upper = 1.96*ALL.ALL_GENO.STEPS.SD/sqrt(prod(dim(TG.INT_ERE.ALL_GENO.STEPS.N))-1))
axis(1,c(.75,2,3.25,4.5,5.75,7),c("TG","PG","MG","TH","PH","MH"),cex.axis=0.5)
legend(4.5,12,legend=c("All ERE GC","Common ERE GC","All ERE HD","Common ERE HD"),fill=c("darkred","red","darkblue","skyblue2"),cex=0.5)

plot(  log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), MG.ALL_ERE.ALL_GENO.AVG,pch=19,cex=0.6,ylim=c(1,13),ylab="Average Path Length",xlab="log10(Population Size)",main="Positive+Negative Selection All Starting")
points(log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), PG.ALL_ERE.ALL_GENO.AVG,pch=19,cex=0.6,col="red")
points(log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), TG.ALL_ERE.ALL_GENO.AVG,pch=19,cex=0.6,col="blue")

plot(  log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), MG.INT_ERE.ALL_GENO.AVG,pch=19,cex=0.6,ylim=c(1,13),ylab="Average Path Length",xlab="log10(Population Size)",main="Positive+Negative Selection Common Starting")
points(log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), PG.INT_ERE.ALL_GENO.AVG,pch=19,cex=0.6,col="red")
points(log10(c(1,3,5,10,17,31,56,100,177,316,562,1000,1778,3162,5263,10000)), TG.INT_ERE.ALL_GENO.AVG,pch=19,cex=0.6,col="blue")
##dev.off()

##Permutation test for difference in path length for all starting genotype
N <- 10000

TG_PG.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TG.ALL_ERE.ALL_GENO.STEPS.N,PG.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- TG.ALL_ERE.ALL_GENO.STEPS.AVG - PG.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TG_PG.ALL_ERE.ALL_GENO.STEPS.p)/length(TG_PG.ALL_ERE.ALL_GENO.STEPS.p)

TG_MG.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TG.ALL_ERE.ALL_GENO.STEPS.N,MG.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- TG.ALL_ERE.ALL_GENO.STEPS.AVG - MG.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TG_MG.ALL_ERE.ALL_GENO.STEPS.p)/length(TG_MG.ALL_ERE.ALL_GENO.STEPS.p)

PG_MG.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(PG.ALL_ERE.ALL_GENO.STEPS.N,MG.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- PG.ALL_ERE.ALL_GENO.STEPS.AVG - MG.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < PG_MG.ALL_ERE.ALL_GENO.STEPS.p)/length(PG_MG.ALL_ERE.ALL_GENO.STEPS.p)

TG_PG.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TG.INT_ERE.ALL_GENO.STEPS.N,PG.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- TG.INT_ERE.ALL_GENO.STEPS.AVG - PG.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TG_PG.INT_ERE.ALL_GENO.STEPS.p)/length(TG_PG.INT_ERE.ALL_GENO.STEPS.p)

TG_MG.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TG.INT_ERE.ALL_GENO.STEPS.N,MG.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- TG.INT_ERE.ALL_GENO.STEPS.AVG - MG.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TG_MG.INT_ERE.ALL_GENO.STEPS.p)/length(TG_MG.INT_ERE.ALL_GENO.STEPS.p)

PG_MG.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(PG.INT_ERE.ALL_GENO.STEPS.N,MG.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- PG.INT_ERE.ALL_GENO.STEPS.AVG - MG.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < PG_MG.INT_ERE.ALL_GENO.STEPS.p)/length(PG_MG.INT_ERE.ALL_GENO.STEPS.p)

TH_PH.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TH.ALL_ERE.ALL_GENO.STEPS.N,PH.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- TH.ALL_ERE.ALL_GENO.STEPS.AVG - PH.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TH_PH.ALL_ERE.ALL_GENO.STEPS.p)/length(TH_PH.ALL_ERE.ALL_GENO.STEPS.p)

TH_MH.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TH.ALL_ERE.ALL_GENO.STEPS.N,MH.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- TH.ALL_ERE.ALL_GENO.STEPS.AVG - MH.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TH_MH.ALL_ERE.ALL_GENO.STEPS.p)/length(TH_MH.ALL_ERE.ALL_GENO.STEPS.p)

PH_MH.ALL_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(PH.ALL_ERE.ALL_GENO.STEPS.N,MH.ALL_ERE.ALL_GENO.STEPS.N,N)
OBS <- PH.ALL_ERE.ALL_GENO.STEPS.AVG - MH.ALL_ERE.ALL_GENO.STEPS.AVG
sum(OBS < PH_MH.ALL_ERE.ALL_GENO.STEPS.p)/length(PH_MH.ALL_ERE.ALL_GENO.STEPS.p)

TH_PH.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TH.INT_ERE.ALL_GENO.STEPS.N,PH.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- TH.INT_ERE.ALL_GENO.STEPS.AVG - PH.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TH_PH.INT_ERE.ALL_GENO.STEPS.p)/length(TH_PH.INT_ERE.ALL_GENO.STEPS.p)

TH_MH.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(TH.INT_ERE.ALL_GENO.STEPS.N,MH.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- TH.INT_ERE.ALL_GENO.STEPS.AVG - MH.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < TH_MH.INT_ERE.ALL_GENO.STEPS.p)/length(TH_MH.INT_ERE.ALL_GENO.STEPS.p)

PH_MH.INT_ERE.ALL_GENO.STEPS.p <- permutation.test.matrix(PH.INT_ERE.ALL_GENO.STEPS.N,MH.INT_ERE.ALL_GENO.STEPS.N,N)
OBS <- PH.INT_ERE.ALL_GENO.STEPS.AVG - MH.INT_ERE.ALL_GENO.STEPS.AVG
sum(OBS < PH_MH.INT_ERE.ALL_GENO.STEPS.p)/length(PH_MH.INT_ERE.ALL_GENO.STEPS.p)


##Partition differences into Genetic code/Hamming distance
##Main vs Pairwise vs Third order epistassi
##All starting genotypes vs Common starting genotypes
##With vs without selection
PARTITION <- data.frame(STEPS=c(ALL.ALL_GENO.STEPS.AVG,ALL.ALL_GENO.SEL.STEPS.AVG), MODEL = rep(c("T","T","P","P","M","M"),4),NETWORK = rep(c(rep("G",6),rep("H",6)),2), SET = rep(c(rep(c("A","S"),6)),2), SEL=c(rep("Neg",12),rep("Pos",12)) )
PARTITION$MODEL <- as.factor(PARTITION$MODEL)
PARTITION$NETWORK <- as.factor(PARTITION$NETWORK)
PARTITION$SET <- as.factor(PARTITION$SET)
PARTITION$SEL <- as.factor(PARTITION$SEL)

MODEL.OUT <- lm(STEPS ~ 0 + MODEL*NETWORK*SEL+MODEL*SET + NETWORK*SET + SEL*SET, data=PARTITION)
step(MODEL.OUT)
MODEL.OUT <- lm(STEPS ~ 0 + MODEL*NETWORK*SEL + SEL*SET, data=PARTITION)


##Average path length for each starting genotype
#Individual mean for all starting genotypes
TG.ALL_ERE.IND_GENO.STEPS.AVG <- apply(TG.ALL_ERE.ALL_GENO.STEPS.N,2,mean)
PG.ALL_ERE.IND_GENO.STEPS.AVG <- apply(PG.ALL_ERE.ALL_GENO.STEPS.N,2,mean)
MG.ALL_ERE.IND_GENO.STEPS.AVG <- apply(MG.ALL_ERE.ALL_GENO.STEPS.N,2,mean)
TH.ALL_ERE.IND_GENO.STEPS.AVG <- apply(TH.ALL_ERE.ALL_GENO.STEPS.N,2,mean)
PH.ALL_ERE.IND_GENO.STEPS.AVG <- apply(PH.ALL_ERE.ALL_GENO.STEPS.N,2,mean)
MH.ALL_ERE.IND_GENO.STEPS.AVG <- apply(MH.ALL_ERE.ALL_GENO.STEPS.N,2,mean)

TG.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(TG.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
PG.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(PG.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
MG.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(MG.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
TH.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(TH.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
PH.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(PH.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
MH.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- apply(MH.ALL_ERE.ALL_GENO.SEL.STEPS.N,2,mean)

#Individual mean for common starting genotypes
TG.INT_ERE.IND_GENO.STEPS.AVG <- apply(TG.INT_ERE.ALL_GENO.STEPS.N,2,mean)
PG.INT_ERE.IND_GENO.STEPS.AVG <- apply(PG.INT_ERE.ALL_GENO.STEPS.N,2,mean)
MG.INT_ERE.IND_GENO.STEPS.AVG <- apply(MG.INT_ERE.ALL_GENO.STEPS.N,2,mean)
TH.INT_ERE.IND_GENO.STEPS.AVG <- apply(TH.INT_ERE.ALL_GENO.STEPS.N,2,mean)
PH.INT_ERE.IND_GENO.STEPS.AVG <- apply(PH.INT_ERE.ALL_GENO.STEPS.N,2,mean)
MH.INT_ERE.IND_GENO.STEPS.AVG <- apply(MH.INT_ERE.ALL_GENO.STEPS.N,2,mean)

TG.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(TG.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
PG.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(PG.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
MG.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(MG.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
TH.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(TH.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
PH.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(PH.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)
MH.INT_ERE.IND_GENO.SEL.STEPS.AVG <- apply(MH.INT_ERE.ALL_GENO.SEL.STEPS.N,2,mean)

#Collect individual means for all starting genotypes
ALL.ALL_ERE.IND_GENO.STEPS.AVG <- list(TG.ALL_ERE.IND_GENO.STEPS.AVG,
                                       PG.ALL_ERE.IND_GENO.STEPS.AVG,
                                       MG.ALL_ERE.IND_GENO.STEPS.AVG,
                                       TH.ALL_ERE.IND_GENO.STEPS.AVG,
                                       PH.ALL_ERE.IND_GENO.STEPS.AVG,
                                       MH.ALL_ERE.IND_GENO.STEPS.AVG)

ALL.ALL_ERE.IND_GENO.SEL.STEPS.AVG <- list(TG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,
                                           PG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,
                                           MG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,
                                           TH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,
                                           PH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,
                                           MH.ALL_ERE.IND_GENO.SEL.STEPS.AVG)

#Collect individual means for common starting genotypes
ALL.INT_ERE.IND_GENO.STEPS.AVG <- list(TG.INT_ERE.IND_GENO.STEPS.AVG,
                                       PG.INT_ERE.IND_GENO.STEPS.AVG,
                                       MG.INT_ERE.IND_GENO.STEPS.AVG,
                                       TH.INT_ERE.IND_GENO.STEPS.AVG,
                                       PH.INT_ERE.IND_GENO.STEPS.AVG,
                                       MH.INT_ERE.IND_GENO.STEPS.AVG)

ALL.INT_ERE.IND_GENO.SEL.STEPS.AVG <- list(TG.INT_ERE.IND_GENO.SEL.STEPS.AVG,
                                           PG.INT_ERE.IND_GENO.SEL.STEPS.AVG,
                                           MG.INT_ERE.IND_GENO.SEL.STEPS.AVG,
                                           TH.INT_ERE.IND_GENO.SEL.STEPS.AVG,
                                           PH.INT_ERE.IND_GENO.SEL.STEPS.AVG,
                                           MH.INT_ERE.IND_GENO.SEL.STEPS.AVG)

##Plot
#par(mfrow=c(3,2))
#par(pty="s")
#par(mar=c(4,4,4,4))
#hist(TG.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="TG Steps Avg",main="All ERE-specific"); abline(v=mean(TG.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(TH.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="TH Steps Avg",main="All ERE-specific"); abline(v=mean(TH.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PG.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="PG Steps Avg",main="All ERE-specific"); abline(v=mean(PG.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PH.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="PH Steps Avg",main="All ERE-specific"); abline(v=mean(PH.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MG.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="MG Steps Avg",main="All ERE-specific"); abline(v=mean(MG.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MH.ALL_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="MH Steps Avg",main="All ERE-specific"); abline(v=mean(MH.ALL_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#
#hist(TG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="TG SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(TG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(TH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="TH SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(TH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="PG SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(PG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="PH SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(PH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="MG SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(MG.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="MH SEL.STEPS Avg",main="All ERE-specific"); abline(v=mean(MH.ALL_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#
#hist(TG.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="TG Steps Avg",main="Common ERE-specific"); abline(v=mean(TG.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(TH.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="TH Steps Avg",main="Common ERE-specific"); abline(v=mean(TH.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PG.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="PG Steps Avg",main="Common ERE-specific"); abline(v=mean(PG.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PH.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="PH Steps Avg",main="Common ERE-specific"); abline(v=mean(PH.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MG.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,30,2),xlab="MG Steps Avg",main="Common ERE-specific"); abline(v=mean(MG.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MH.INT_ERE.IND_GENO.STEPS.AVG,breaks=seq(0,20,2),xlab="MH Steps Avg",main="Common ERE-specific"); abline(v=mean(MH.INT_ERE.IND_GENO.STEPS.AVG,na.rm=TRUE),col="red")
#
#hist(TG.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="TG SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(TG.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(TH.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="TH SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(TH.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PG.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="PG SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(PG.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(PH.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="PH SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(PH.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MG.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,15,2),xlab="MG SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(MG.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#hist(MH.INT_ERE.IND_GENO.SEL.STEPS.AVG,breaks=seq(0,10,2),xlab="MH SEL.STEPS Avg",main="Common ERE-specific"); abline(v=mean(MH.INT_ERE.IND_GENO.SEL.STEPS.AVG,na.rm=TRUE),col="red")
#
#par(mfrow=c(2,2))
#boxplot(ALL.ALL_ERE.IND_GENO.STEPS.AVG,    notch=TRUE,names=c("TG","PG","MG","TH","PH","MH"),boxwex=0.5,cex.axis=0.5,pch=19,cex=0.2,ylim=c(0,25),cex.main=0.5,main="Average Path Length for each ERE - All ERE Neg Sel")
#boxplot(ALL.ALL_ERE.IND_GENO.SEL.STEPS.AVG,notch=TRUE,names=c("TG","PG","MG","TH","PH","MH"),boxwex=0.5,cex.axis=0.5,pch=19,cex=0.2,ylim=c(0,30),cex.main=0.5,main="Average Path Length for each ERE - All ERE Pos Sel")
#boxplot(ALL.INT_ERE.IND_GENO.STEPS.AVG,    notch=TRUE,names=c("TG","PG","MG","TH","PH","MH"),boxwex=0.5,cex.axis=0.5,pch=19,cex=0.2,ylim=c(0,25),cex.main=0.5,main="Average Path Length for each ERE - Common ERE Neg Sel")
#boxplot(ALL.INT_ERE.IND_GENO.SEL.STEPS.AVG,notch=TRUE,names=c("TG","PG","MG","TH","PH","MH"),boxwex=0.5,cex.axis=0.5,pch=19,cex=0.2,ylim=c(0,15),cex.main=0.5,main="Average Path Length for each ERE - Common ERE Pos Sel")

##Differences in path length between models
#Only uses common ERE-specific genotypes
#Path length differences for individual genotypes for common starting genotypes
TG_PG.INT_ERE.IND_GENO.STEPS.DIFF <- TG.INT_ERE.IND_GENO.STEPS.AVG - PG.INT_ERE.IND_GENO.STEPS.AVG
TG_MG.INT_ERE.IND_GENO.STEPS.DIFF <- TG.INT_ERE.IND_GENO.STEPS.AVG - MG.INT_ERE.IND_GENO.STEPS.AVG
PG_MG.INT_ERE.IND_GENO.STEPS.DIFF <- PG.INT_ERE.IND_GENO.STEPS.AVG - MG.INT_ERE.IND_GENO.STEPS.AVG
TH_PH.INT_ERE.IND_GENO.STEPS.DIFF <- TH.INT_ERE.IND_GENO.STEPS.AVG - PH.INT_ERE.IND_GENO.STEPS.AVG
TH_MH.INT_ERE.IND_GENO.STEPS.DIFF <- TH.INT_ERE.IND_GENO.STEPS.AVG - MH.INT_ERE.IND_GENO.STEPS.AVG
PH_MH.INT_ERE.IND_GENO.STEPS.DIFF <- PH.INT_ERE.IND_GENO.STEPS.AVG - MH.INT_ERE.IND_GENO.STEPS.AVG

TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- TG.INT_ERE.IND_GENO.SEL.STEPS.AVG - PG.INT_ERE.IND_GENO.SEL.STEPS.AVG
TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- TG.INT_ERE.IND_GENO.SEL.STEPS.AVG - MG.INT_ERE.IND_GENO.SEL.STEPS.AVG
PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- PG.INT_ERE.IND_GENO.SEL.STEPS.AVG - MG.INT_ERE.IND_GENO.SEL.STEPS.AVG
TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- TH.INT_ERE.IND_GENO.SEL.STEPS.AVG - PH.INT_ERE.IND_GENO.SEL.STEPS.AVG
TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- TH.INT_ERE.IND_GENO.SEL.STEPS.AVG - MH.INT_ERE.IND_GENO.SEL.STEPS.AVG
PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- PH.INT_ERE.IND_GENO.SEL.STEPS.AVG - MH.INT_ERE.IND_GENO.SEL.STEPS.AVG


#Collect path length differences for individual genotypes for common starting genotypes
ALL.INT_ERE.IND_GENO.STEPS.DIFF <- list(TG_PG.INT_ERE.IND_GENO.STEPS.DIFF,
                                        TG_MG.INT_ERE.IND_GENO.STEPS.DIFF,
                                        PG_MG.INT_ERE.IND_GENO.STEPS.DIFF,
                                        TH_PH.INT_ERE.IND_GENO.STEPS.DIFF,
                                        TH_MH.INT_ERE.IND_GENO.STEPS.DIFF,
                                        PH_MH.INT_ERE.IND_GENO.STEPS.DIFF)

ALL.INT_ERE.IND_GENO.SEL.STEPS.DIFF <- list(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,
                                            TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,
                                            PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,
                                            TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,
                                            TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,
                                            PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF)

##Plot
#par(mfrow=c(3,2))
#hist(TG_PG.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="TG - PG Avg Dist.",main="Common ERE"); abline(v=mean(TG_PG.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#hist(TH_PH.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="TH - PH Avg Dist.",main="Common ERE"); abline(v=mean(TH_PH.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#hist(PG_MG.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="PG - MG Avg Dist.",main="Common ERE"); abline(v=mean(PG_MG.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#hist(PH_MH.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="PH - MH Avg Dist.",main="Common ERE"); abline(v=mean(PH_MH.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#hist(TG_MG.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="TH - MH Avg Dist.",main="Common ERE"); abline(v=mean(TG_MG.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#hist(TH_MH.INT_ERE.IND_GENO.STEPS.DIFF,seq(-7,7,1),xlab="TG - MG Avg Dist.",main="Common ERE"); abline(v=mean(TH_MH.INT_ERE.IND_GENO.STEPS.DIFF),col="red")
#
#hist(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="TG - PG Avg Dist.",main="Common ERE"); abline(v=mean(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#hist(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="TH - PH Avg Dist.",main="Common ERE"); abline(v=mean(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#hist(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="PG - MG Avg Dist.",main="Common ERE"); abline(v=mean(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#hist(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="PH - MH Avg Dist.",main="Common ERE"); abline(v=mean(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#hist(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="TH - MH Avg Dist.",main="Common ERE"); abline(v=mean(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#hist(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,seq(-8,8,1),xlab="TG - MG Avg Dist.",main="Common ERE"); abline(v=mean(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF),col="red")
#
#par(mfrow=c(2,1))
#boxplot(ALL.INT_ERE.IND_GENO.STEPS.DIFF,notch=TRUE,names=c("TG-PG","TG-MG","PG-MG","TH-PH","TH-MH","PH-MH"),boxwex=0.5,pch=19,cex=0.3,ylim=c(-8,8),cex.axis=0.5,cex.main=0.5,las=2,main="Average Path Length Difference for each Common ERE genotype Neg Sel")
#abline(h=0)
#boxplot(ALL.INT_ERE.IND_GENO.SEL.STEPS.DIFF,notch=TRUE,names=c("TG-PG","TG-MG","PG-MG","TH-PH","TH-MH","PH-MH"),boxwex=0.5,pch=19,cex=0.3,ylim=c(-8,8),cex.axis=0.5,cex.main=0.5,las=2,main="Average Path Length Difference for each Common ERE genotype Pos Sel")
#abline(h=0)
#
#par(mfrow=c(2,1))
#plot(jitter(c(rep(1:3,each=97),rep(4:6,each=59))),unlist(ALL.INT_ERE.IND_GENO.STEPS.DIFF),pch=19,cex=0.3,cex.axis=0.5,las=2,xaxt="n",xlab="",ylab="",cex.main=0.5,main="Average Path Length Difference for each Common ERE genotype Neg Sel")
#axis(1,1:6,c("TG-PG","TG-MG","PG-MG","TH-PH","TH-MH","PH-MH"),cex.axis=0.5,las=2)
#abline(h=0)
#plot(jitter(c(rep(1:3,each=97),rep(4:6,each=59))),unlist(ALL.INT_ERE.IND_GENO.SEL.STEPS.DIFF),pch=19,cex=0.3,cex.axis=0.5,las=2,xaxt="n",xlab="",ylab="",cex.main=0.5,main="Average Path Length Difference for each Common ERE genotype Pos Sel")
#axis(1,1:6,c("TG-PG","TG-MG","PG-MG","TH-PH","TH-MH","PH-MH"),cex.axis=0.5,las=2)
#abline(h=0)

##Permutation test for difference in path length for each starting genotype
N.GENOTYPES <- ncol(TG.INT_ERE.ALL_GENO.STEPS.N)
N.PERMUTATIONS <- 10000
N.SIMULATIONS <- 1000

#TG_PG.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],PG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],PG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TG.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(PG.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TG_PG.INT_ERE.IND_GENO.STEPS.p) <- names(TG_PG.INT_ERE.IND_GENO.STEPS.DIFF)
#
#TG_MG.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],MG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],MG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TG.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(MG.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TG_MG.INT_ERE.IND_GENO.STEPS.p) <- names(TG_MG.INT_ERE.IND_GENO.STEPS.DIFF)
#
#PG_MG.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(PG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],MG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(PG.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],MG.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(PG.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(MG.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(PG_MG.INT_ERE.IND_GENO.STEPS.p) <- names(PG_MG.INT_ERE.IND_GENO.STEPS.DIFF)
#
#N.GENOTYPES <- ncol(TH.INT_ERE.ALL_GENO.STEPS.N)
#
#TH_PH.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],PH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],PH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TH.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(PH.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TH_PH.INT_ERE.IND_GENO.STEPS.p) <- names(TH_PH.INT_ERE.IND_GENO.STEPS.DIFF)
#
#TH_MH.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],MH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],MH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TH.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(MH.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TH_MH.INT_ERE.IND_GENO.STEPS.p) <- names(TH_MH.INT_ERE.IND_GENO.STEPS.DIFF)
#
#PH_MH.INT_ERE.IND_GENO.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(PH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x],MH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(PH.INT_ERE.ALL_GENO.STEPS.N[-SAMPLE,x],MH.INT_ERE.ALL_GENO.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(PH.INT_ERE.ALL_GENO.STEPS.N[,x]) - mean(MH.INT_ERE.ALL_GENO.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(PH_MH.INT_ERE.IND_GENO.STEPS.p) <- names(PH_MH.INT_ERE.IND_GENO.STEPS.DIFF)
#
#save(TG_MG.INT_ERE.IND_GENO.STEPS.p,file="TG_MG.INT_ERE.IND_GENO.STEPS.p.rda")
#save(TG_PG.INT_ERE.IND_GENO.STEPS.p,file="TG_PG.INT_ERE.IND_GENO.STEPS.p.rda")
#save(PG_MG.INT_ERE.IND_GENO.STEPS.p,file="PG_MG.INT_ERE.IND_GENO.STEPS.p.rda")
#save(TH_MH.INT_ERE.IND_GENO.STEPS.p,file="TH_MH.INT_ERE.IND_GENO.STEPS.p.rda")
#save(TH_PH.INT_ERE.IND_GENO.STEPS.p,file="TH_PH.INT_ERE.IND_GENO.STEPS.p.rda")
#save(PH_MH.INT_ERE.IND_GENO.STEPS.p,file="PH_MH.INT_ERE.IND_GENO.STEPS.p.rda")

load("TG_MG.INT_ERE.IND_GENO.STEPS.p.rda")
load("TG_PG.INT_ERE.IND_GENO.STEPS.p.rda")
load("PG_MG.INT_ERE.IND_GENO.STEPS.p.rda")
load("TH_MH.INT_ERE.IND_GENO.STEPS.p.rda")
load("TH_PH.INT_ERE.IND_GENO.STEPS.p.rda")
load("PH_MH.INT_ERE.IND_GENO.STEPS.p.rda")

#N.GENOTYPES <- ncol(TG.INT_ERE.ALL_GENO.SEL.STEPS.N)

#TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],PG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],PG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(PG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],MG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],MG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(MG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(PG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],MG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(PG.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],MG.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(PG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(MG.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#N.GENOTYPES <- ncol(TH.INT_ERE.ALL_GENO.SEL.STEPS.N)
#
#TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],PH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],PH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(PH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],MH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],MH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(TH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(MH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p <- sapply(1:N.GENOTYPES,FUN = function(x) {
#  OUT <- sapply(1:N.PERMUTATIONS,FUN = function(y) {
#    SAMPLE <- sample(1:N.SIMULATIONS,N.SIMULATIONS/2,replace = FALSE)
#    S1 <- mean(c(PH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x],MH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x]))
#    S2 <- mean(c(PH.INT_ERE.ALL_GENO.SEL.STEPS.N[-SAMPLE,x],MH.INT_ERE.ALL_GENO.SEL.STEPS.N[ SAMPLE,x]))
#    return(S1-S2)
#  })
#  OBS <- mean(PH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x]) - mean(MH.INT_ERE.ALL_GENO.SEL.STEPS.N[,x])
#  return(sum(OBS < OUT)/length(OUT))
#}); names(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p) <- names(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF)
#
#save(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,file="TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
#save(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p,file="TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
#save(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,file="PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
#save(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p,file="TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
#save(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p,file="TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
#save(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p,file="PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")

load("TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
load("TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
load("PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
load("TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
load("TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")
load("PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p.rda")

##Identify significant changes in step number
sum(TG_PG.INT_ERE.IND_GENO.STEPS.p < 0.05 | TG_PG.INT_ERE.IND_GENO.STEPS.p > .95)
sum(TG_MG.INT_ERE.IND_GENO.STEPS.p < 0.05 | TG_MG.INT_ERE.IND_GENO.STEPS.p > .95)
sum(PG_MG.INT_ERE.IND_GENO.STEPS.p < 0.05 | PG_MG.INT_ERE.IND_GENO.STEPS.p > .95)
sum(TH_PH.INT_ERE.IND_GENO.STEPS.p < 0.05 | TH_PH.INT_ERE.IND_GENO.STEPS.p > .95)
sum(TH_MH.INT_ERE.IND_GENO.STEPS.p < 0.05 | TH_MH.INT_ERE.IND_GENO.STEPS.p > .95)
sum(PH_MH.INT_ERE.IND_GENO.STEPS.p < 0.05 | PH_MH.INT_ERE.IND_GENO.STEPS.p > .95)

sum(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p > .95)
sum(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p > .95)
sum(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p > .95)
sum(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p > .95)
sum(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p > .95)
sum(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p < 0.05 | PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p > .95)

##Plot difference vs. p-value
par(mfrow=c(2,3))
plot(TG_PG.INT_ERE.IND_GENO.STEPS.DIFF,TG_PG.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="TG-PG Steps",ylab="TG-PG Steps p-value"); abline(h=0.95);abline(h=0.05)
plot(TG_MG.INT_ERE.IND_GENO.STEPS.DIFF,TG_MG.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="TG-MG Steps",ylab="TG-MG Steps p-value"); abline(h=0.95);abline(h=0.05)
plot(PG_MG.INT_ERE.IND_GENO.STEPS.DIFF,PG_MG.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="PG-MG Steps",ylab="PG-MG Steps p-value"); abline(h=0.95);abline(h=0.05)
plot(TH_PH.INT_ERE.IND_GENO.STEPS.DIFF,TH_PH.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="TH-PH Steps",ylab="TH-PH Steps p-value"); abline(h=0.95);abline(h=0.05)
plot(TH_MH.INT_ERE.IND_GENO.STEPS.DIFF,TH_MH.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="TH-MH Steps",ylab="TH-MH Steps p-value"); abline(h=0.95);abline(h=0.05)
plot(PH_MH.INT_ERE.IND_GENO.STEPS.DIFF,PH_MH.INT_ERE.IND_GENO.STEPS.p,pch=19,cex=0.6,xlab="PH-MH Steps",ylab="PH-MH Steps p-value"); abline(h=0.95);abline(h=0.05)

par(mfrow=c(2,3))
plot(TG_PG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="TG-PG SEL.STEPS",ylab="TG-PG SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)
plot(TG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="TG-MG SEL.STEPS",ylab="TG-MG SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)
plot(PG_MG.INT_ERE.IND_GENO.SEL.STEPS.DIFF,PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="PG-MG SEL.STEPS",ylab="PG-MG SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)
plot(TH_PH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,TH_PH.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="TH-PH SEL.STEPS",ylab="TH-PH SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)
plot(TH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,TH_MH.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="TH-MH SEL.STEPS",ylab="TH-MH SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)
plot(PH_MH.INT_ERE.IND_GENO.SEL.STEPS.DIFF,PH_MH.INT_ERE.IND_GENO.SEL.STEPS.p,pch=19,cex=0.6,xlab="PH-MH SEL.STEPS",ylab="PH-MH SEL.STEPS p-value"); abline(h=0.95);abline(h=0.05)

##Compare step number for each common ERE genotype
SUBSET <- which(TG_MG.INT_ERE.IND_GENO.STEPS.p > 0.05 & TG_MG.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(TG_MG.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ TG_MG.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(MG.INT_ERE.IND_GENO.STEPS.AVG,TG.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="MG Steps",ylab="TG Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

SUBSET <- which(TG_PG.INT_ERE.IND_GENO.STEPS.p > 0.05 & TG_PG.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(TG_PG.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ TG_PG.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(PG.INT_ERE.IND_GENO.STEPS.AVG,TG.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="PG Steps",ylab="TG Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

SUBSET <- which(PG_MG.INT_ERE.IND_GENO.STEPS.p > 0.05 & PG_MG.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(PG_MG.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ PG_MG.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(MG.INT_ERE.IND_GENO.STEPS.AVG,PG.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="MG Steps",ylab="PG Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

SUBSET <- which(TH_MH.INT_ERE.IND_GENO.STEPS.p > 0.05 & TH_MH.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(TH_MH.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ TH_MH.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(MH.INT_ERE.IND_GENO.STEPS.AVG,TH.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="MH Steps",ylab="TH Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

SUBSET <- which(TH_PH.INT_ERE.IND_GENO.STEPS.p > 0.05 & TH_PH.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(TH_PH.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ TH_PH.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(PH.INT_ERE.IND_GENO.STEPS.AVG,TH.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="PH Steps",ylab="TH Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

SUBSET <- which(PH_MH.INT_ERE.IND_GENO.STEPS.p > 0.05 & PH_MH.INT_ERE.IND_GENO.STEPS.p < 0.95)
MODEL <- lm(PH_MH.INT_ERE.IND_GENO.STEPS.p[SUBSET] ~ PH_MH.INT_ERE.IND_GENO.STEPS.DIFF[SUBSET])
plot(MH.INT_ERE.IND_GENO.STEPS.AVG,PH.INT_ERE.IND_GENO.STEPS.AVG,pch=19,cex=0.6,xlab="MH Steps",ylab="PH Steps",ylim=c(0,20),xlim=c(0,20))
abline(a=0,b=1)
abline(a=(0.95 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)
abline(a=(0.05 - MODEL$coefficients[1])/MODEL$coefficients[2],b=1,lty=2)

##Compare average step number for all common ERE genotypes across models
par(mfrow=c(1,1))
G.STEPS     <- data.frame(MG=MG.INT_ERE.IND_GENO.STEPS.AVG,PG=PG.INT_ERE.IND_GENO.STEPS.AVG,TG=TG.INT_ERE.IND_GENO.STEPS.AVG,MG.PG.p = PG_MG.INT_ERE.IND_GENO.STEPS.p,MG.TG.p=TG_MG.INT_ERE.IND_GENO.STEPS.p,PG.TG.p=TG_PG.INT_ERE.IND_GENO.STEPS.p)
G.SEL.STEPS <- data.frame(MG=MG.INT_ERE.IND_GENO.SEL.STEPS.AVG,PG=PG.INT_ERE.IND_GENO.SEL.STEPS.AVG,TG=TG.INT_ERE.IND_GENO.SEL.STEPS.AVG,MG.PG.p = PG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,MG.TG.p=TG_MG.INT_ERE.IND_GENO.SEL.STEPS.p,PG.TG.p=TG_PG.INT_ERE.IND_GENO.SEL.STEPS.p)

##Effects as epistasis is added
COLOR <- c("#42EBF5","#000000","#A94E35","#999999")
I <- 1:nrow(G.STEPS)
plot(0,0,type="n",xlim=c(1,3),ylim=c(0,20),xlab="",ylab="Avg Steps",xaxt="n",main="Neg Sel")
axis(1,at=c(1,2,3),labels=c("MG","PG","TG"))
for(i in I) {
  if(G.STEPS$MG.PG.p[i] < 0.05 & G.STEPS$MG.TG.p[i] < 0.05) {
    points(1:3,G.STEPS[i,1:3],type="l",lwd=2,col=COLOR[1])
  }else if(G.STEPS$MG.PG.p[i] > .95 & G.STEPS$MG.TG.p[i] > .95) {
    points(1:3,G.STEPS[i,1:3],type="l",lwd=2,col=COLOR[3])
  }else if(G.STEPS$MG.PG.p[i] < .95 & G.STEPS$MG.PG.p[i] > .05 & G.STEPS$MG.TG.p[i] < .95 & G.STEPS$MG.TG.p[i] > .05){
    points(1:3,G.STEPS[i,1:3],type="l",lwd=2,col=COLOR[2])
  }else {
    points(1:3,G.STEPS[i,1:3],type="l",lwd=2,col=COLOR[4])
  }
}

COLOR <- c("#42EBF5","#000000","#A94E35","#999999")
I <- 1:nrow(G.SEL.STEPS)
plot(0,0,type="n",xlim=c(1,3),ylim=c(0,12),xlab="",ylab="Avg SEL.STEPS",xaxt="n",main="Pos Sel")
axis(1,at=c(1,2,3),labels=c("MG","PG","TG"))
for(i in I) {
  if(G.SEL.STEPS$MG.PG.p[i] < 0.05 & G.SEL.STEPS$MG.TG.p[i] < 0.05) {
    points(1:3,G.SEL.STEPS[i,1:3],type="l",lwd=2,col=COLOR[1])
  }else if(G.SEL.STEPS$MG.PG.p[i] > .95 & G.SEL.STEPS$MG.TG.p[i] > .95) {
    points(1:3,G.SEL.STEPS[i,1:3],type="l",lwd=2,col=COLOR[3])
  }else if(G.SEL.STEPS$MG.PG.p[i] < .95 & G.SEL.STEPS$MG.PG.p[i] > .05 & G.SEL.STEPS$MG.TG.p[i] < .95 & G.SEL.STEPS$MG.TG.p[i] > .05){
    points(1:3,G.SEL.STEPS[i,1:3],type="l",lwd=2,col=COLOR[2])
  }else {
    points(1:3,G.SEL.STEPS[i,1:3],type="l",lwd=2,col=COLOR[4])
  }
}

##Network Graphs
#Make adjacency matrixes and graphs
G.ALL_ERE.IND_GENO.SET <- unique(c(TG.ERE.LIST,PG.ERE.LIST,MG.ERE.LIST))
G.INT_ERE.IND_GENO.SET <- TG.ERE.LIST[TG.ERE.INTERSECT]

G.INT_ERE.IND_GENO.INDEX <- index.adjaceny(G.ALL_ERE.IND_GENO.SET,code="Z")
G.INT_ERE.IND_GENO.ADJM  <- make.adjaceny(G.ALL_ERE.IND_GENO.SET,G.INT_ERE.IND_GENO.INDEX )
colnames(G.INT_ERE.IND_GENO.ADJM) <- G.ALL_ERE.IND_GENO.SET; rownames(G.INT_ERE.IND_GENO.ADJM) <- G.ALL_ERE.IND_GENO.SET

G.INT_ERE.IND_GENO.NET  <- graph.adjacency(G.INT_ERE.IND_GENO.ADJM, mode="undirected")
G.INT_ERE.IND_GENO.DIST <- distances(G.INT_ERE.IND_GENO.NET,v=G.ALL_ERE.IND_GENO.SET,to=G.ALL_ERE.IND_GENO.SET,mode="all"); is.na(G.INT_ERE.IND_GENO.DIST) <- sapply(G.INT_ERE.IND_GENO.DIST,is.infinite)

save(G.INT_ERE.IND_GENO.ADJM, file="G.INT_ERE.IND_GENO.ADJM.rda")
save(G.INT_ERE.IND_GENO.NET,  file="G.INT_ERE.IND_GENO.NET.rda")
save(G.INT_ERE.IND_GENO.DIST, file="G.INT_ERE.IND_GENO.DIST.rda")

#Creat source and target connections for graphing
G.INT_ERE.IND_GENO.SOURCE  <- vector()
G.INT_ERE.IND_GENO.TARGET <- vector()
I <- 1:length(G.ALL_ERE.IND_GENO.SET)
for(i in I) {
  J <- which(G.ALL_ERE.IND_GENO.SET %in% get.neighbors(G.ALL_ERE.IND_GENO.SET[i],code="Z"))
  for(j in J){
    G.INT_ERE.IND_GENO.SOURCE <- c(G.INT_ERE.IND_GENO.SOURCE, i)
    G.INT_ERE.IND_GENO.TARGET <- c(G.INT_ERE.IND_GENO.TARGET, j)
  }
}
G.INT_ERE.IND_GENO.EDGES <- data.frame(source=G.INT_ERE.IND_GENO.SOURCE, target=G.INT_ERE.IND_GENO.TARGET, stringsAsFactors = F)
G.INT_ERE.IND_GENO.GRAPH <- data.frame(id=1:length(G.ALL_ERE.IND_GENO.SET),
                                       label=G.ALL_ERE.IND_GENO.SET,MG_PG.NEG.p=NA,MG_TG.NEG.p=NA,PG_TG.NEG.p=NA,
                                       MG_PG.POS.p=NA,MG_TG.POS.p=NA,PG_TG.POS.p=NA,
                                       MG_PG.NEG.CLASS=NA,MG_TG.NEG.CLASS=NA,PG_TG.NEG.CLASS=NA,
                                       MG_PG.POS.CLASS=NA,MG_TG.POS.CLASS=NA,PG_TG.POS.CLASS=NA,
                                       MG=0,PG=0,TG=0,
                                       MG.ERE,MG.SRE,PG.ERE,PG.SRE,TG.ERE,TG.SRE,
                                       MG.SPEC,PG.SPEC,TG.SPEC,stringsAsFactors = F)

#Add properties for graphing
INTERSECT.IDS <- which(G.INT_ERE.IND_GENO.GRAPH$label %in% G.INT_ERE.IND_GENO.SET)

G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.p"] <- G.STEPS$MG.PG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.p"] <- G.STEPS$MG.TG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.p"] <- G.STEPS$PG.TG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.p"] <- G.SEL.STEPS$MG.PG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.p"] <- G.SEL.STEPS$MG.TG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.p"] <- G.SEL.STEPS$PG.TG.p
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.NEG.p"] < .05] <- -1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.NEG.p"] < .05] <- -1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.NEG.p"] < .05] <- -1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_PG.POS.p"] < .05] <- -1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"MG_TG.POS.p"] < .05] <- -1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.p"] > .95] <- 1
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.p"] < .95 & G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.p"] > 0.05] <- 0
G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.CLASS"][G.INT_ERE.IND_GENO.GRAPH[INTERSECT.IDS,"PG_TG.POS.p"] < .05] <- -1

G.INT_ERE.IND_GENO.GRAPH[which(G.INT_ERE.IND_GENO.GRAPH$label %in% MG.ERE.LIST),"MG"] <- 1
G.INT_ERE.IND_GENO.GRAPH[which(G.INT_ERE.IND_GENO.GRAPH$label %in% PG.ERE.LIST),"PG"] <- 1
G.INT_ERE.IND_GENO.GRAPH[which(G.INT_ERE.IND_GENO.GRAPH$label %in% TG.ERE.LIST),"TG"] <- 1
G.INT_ERE.IND_GENO.GRAPH$X1 <- substring(G.INT_ERE.IND_GENO.GRAPH$label,1,1)
G.INT_ERE.IND_GENO.GRAPH$X2 <- substring(G.INT_ERE.IND_GENO.GRAPH$label,2,2)
G.INT_ERE.IND_GENO.GRAPH$X3 <- substring(G.INT_ERE.IND_GENO.GRAPH$label,3,3)
G.INT_ERE.IND_GENO.GRAPH$X4 <- substring(G.INT_ERE.IND_GENO.GRAPH$label,4,4)

G.INT_ERE.IND_GENO.GRAPH$MG.ERE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("E",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.ME.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$MG.SRE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("S",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.ME.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$PG.ERE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("E",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.PE.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$PG.SRE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("S",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.PE.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$TG.ERE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("E",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.TE.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$TG.SRE <- -1*unlist(c(DT.JOINT[which(DT.JOINT$AAseq %in% paste0("S",G.INT_ERE.IND_GENO.GRAPH$label)),"PRED.TE.LINK"]))
G.INT_ERE.IND_GENO.GRAPH$MG.SPEC <- G.INT_ERE.IND_GENO.GRAPH$MG.ERE - G.INT_ERE.IND_GENO.GRAPH$MG.SRE
G.INT_ERE.IND_GENO.GRAPH$PG.SPEC <- G.INT_ERE.IND_GENO.GRAPH$PG.ERE - G.INT_ERE.IND_GENO.GRAPH$PG.SRE
G.INT_ERE.IND_GENO.GRAPH$TG.SPEC <- G.INT_ERE.IND_GENO.GRAPH$TG.ERE - G.INT_ERE.IND_GENO.GRAPH$TG.SRE

write.gexf(nodes=G.INT_ERE.IND_GENO.GRAPH[,1:2],nodesAtt=G.INT_ERE.IND_GENO.GRAPH[,3:30],edges=G.INT_ERE.IND_GENO.EDGES,output="G.INT_ERE.IND_GENO.gexf")

#######################
###4. Neighbor Class###
#######################
###Calculate frequency of classes among neighbors as simulations proceed
N <- 1:100
##MG Intersected ERE starting genotypes
#MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors <- MG.INT_ERE.ALL_GENO.SIMULATE$Path
#MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- MG.INT_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(MG.INT_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(MG.INT_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(MG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(MG.ACT.NET,v=unlist(MG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "M"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

##PG Intersected ERE starting genotypes
#PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors <- PG.INT_ERE.ALL_GENO.SIMULATE$Path
#PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- PG.INT_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(PG.INT_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(PG.INT_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(PG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(PG.ACT.NET,v=unlist(PG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "P"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

###TG Intersected ERE starting genotypes
#TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors <- TG.INT_ERE.ALL_GENO.SIMULATE$Path
#TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- TG.INT_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(TG.INT_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(TG.INT_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(TG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(TG.ACT.NET,v=unlist(TG.INT_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "T"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

##MG all ERE starting genotypes
#MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors <- MG.ALL_ERE.ALL_GENO.SIMULATE$Path
#MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- MG.ALL_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(MG.ALL_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(MG.ALL_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(MG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(MG.ACT.NET,v=unlist(MG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "M"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      MG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

##PG all ERE starting genotypes
#PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors <- PG.ALL_ERE.ALL_GENO.SIMULATE$Path
#PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- PG.ALL_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(PG.ALL_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(PG.ALL_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(PG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(PG.ACT.NET,v=unlist(PG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "P"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      PG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

###TG all ERE starting genotypes
#TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors <- TG.ALL_ERE.ALL_GENO.SIMULATE$Path
#TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class <- TG.ALL_ERE.ALL_GENO.SIMULATE$Path
#
#I <- 1:length(TG.ALL_ERE.ALL_GENO.SIMULATE$Path)
#J <- 1:length(TG.ALL_ERE.ALL_GENO.SIMULATE$Path[[1]])
#for(i in I) {
#  for(j in J) {
#    K <- 1:length(unlist(TG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j]))
#    for(k in K) {
#      TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k] <- list(names(neighbors(TG.ACT.NET,v=unlist(TG.ALL_ERE.ALL_GENO.SIMULATE$Path[[i]][j])[k])))
#      TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][k] <- TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]
#      M <- 1:length(unlist(TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k]))
#      for(m in M) {
#        TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[j]][[k]][m] <- as.character(get.genotype.class(unlist(TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors[[i]][[j]][k])[m],NETWORKTYPE = "T"))
#      }
#    }
#  }
#}
#save(MG.INT_ERE.ALL_GENO.SIMULATE,file="MG.INT_ERE.ALL_GENO.SIMULATE.rda")
#
#TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP <- lapply(N,FUN=function(z) {
#  unlist(lapply(I,FUN=function(x) {
#    lapply(J,FUN=function(y) {
#      TG.ALL_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[x]][[y]][z]
#    }) 
#  }))
#})
#save(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP, file="TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")
load("TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP.rda")

TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT <- matrix(0,nrow=length(N),ncol=3)
colnames(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT) <- c("E","P","S")
for(n in N) {
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,1] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,2] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.COUNT[n,3] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")
}

TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ <- matrix(0,nrow=length(N),ncol=3)
colnames(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ) <- c("E","P","S")
for(n in N) {
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,1] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="ERE-specific")/length(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,2] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="promiscuous" )/length(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
  TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[n,3] <- sum(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]]=="SRE-specific")/length(TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.STEP[[n]])
}

##Plot results
pdf("Simulation.Class.Freq.pdf")
par(pty="s")
#Initial Frequency of neighbor class
par(mfrow=c(1,2))
barplot(c(MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3],
          PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3],
          TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3]),
        space=c(0,0,0,.5,0,0,.5,0,0),main="All",ylab="Initital Frequency",ylim=c(0,1),
        col=c("purple","purple","purple","skyblue2","skyblue2","skyblue2","green","green","green"))

barplot(c(MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,1],
          MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,2],
          MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3],
          PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3],
          TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[1,3]),
        space=c(0,0,0,.5,0,0,.5,0,0),main="Intersect",ylab="Initital Frequency",ylim=c(0,1),
        col=c("purple","purple","purple","skyblue2","skyblue2","skyblue2","green","green","green"))

#Change in neighbor class over simulation
plot(  1:100,MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",col="purple",xlim=c(0,10),ylim=c(0,1),xlab="Step",ylab="Frequency",main="All")
points(1:100,MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",col="blue")
points(1:100,MG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",col="green")
points(1:100,PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",lwd=2,col="purple")
points(1:100,PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",lwd=2,col="blue")
points(1:100,PG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",lwd=2,col="green")
points(1:100,TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",lwd=3,col="purple")
points(1:100,TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",lwd=3,col="blue")
points(1:100,TG.ALL_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",lwd=3,col="green")

plot(  1:100,MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",col="purple",xlim=c(0,10),ylim=c(0,1),xlab="Step",ylab="Frequency",main="Intersect")
points(1:100,MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",col="blue")
points(1:100,MG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",col="green")
points(1:100,PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",lwd=2,col="purple")
points(1:100,PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",lwd=2,col="blue")
points(1:100,PG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",lwd=2,col="green")
points(1:100,TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,1],type="l",lwd=3,col="purple")
points(1:100,TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,2],type="l",lwd=3,col="blue")
points(1:100,TG.INT_ERE.ALL_GENO.NEIGHBOR.CLASS.FREQ[,3],type="l",lwd=3,col="green")

dev.off()

#################################
###5. Ending genotype identity###
#################################
##Get ending genotypes
TG.ALL_ERE.ALL_GENO.END <- TG.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype
PG.ALL_ERE.ALL_GENO.END <- PG.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype
MG.ALL_ERE.ALL_GENO.END <- MG.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype
TH.ALL_ERE.ALL_GENO.END <- TH.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype
PH.ALL_ERE.ALL_GENO.END <- PH.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype
MH.ALL_ERE.ALL_GENO.END <- MH.ALL_ERE.ALL_GENO.SIMULATE$End.Genotype

##Get ending geontypes for a common set of ERE starting points
TG.INT_ERE.ALL_GENO.END <- TG.INT_ERE.ALL_GENO.SIMULATE$End.Genotype
PG.INT_ERE.ALL_GENO.END <- PG.INT_ERE.ALL_GENO.SIMULATE$End.Genotype
MG.INT_ERE.ALL_GENO.END <- MG.INT_ERE.ALL_GENO.SIMULATE$End.Genotype
TH.INT_ERE.ALL_GENO.END <- TH.INT_ERE.ALL_GENO.SIMULATE$End.Genotype
PH.INT_ERE.ALL_GENO.END <- PH.INT_ERE.ALL_GENO.SIMULATE$End.Genotype
MH.INT_ERE.ALL_GENO.END <- MH.INT_ERE.ALL_GENO.SIMULATE$End.Genotype

##Distribution of ending genotypes for each starting genotype
TG.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(TG.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
})
PG.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(PG.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
})
MG.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(MG.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
})
TH.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(TH.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
})
PH.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(PH.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
})
MH.INT_ERE.ALL_GENO.END.GENO.COUNT <- apply(MH.INT_ERE.ALL_GENO.END,2,function(x) {
  table(factor(x,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
})

##Binary reached/not reached
TG.INT_ERE.ALL_GENO.END.GENO.BINARY <- TG.INT_ERE.ALL_GENO.END.GENO.COUNT; TG.INT_ERE.ALL_GENO.END.GENO.BINARY[which(TG.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1
PG.INT_ERE.ALL_GENO.END.GENO.BINARY <- PG.INT_ERE.ALL_GENO.END.GENO.COUNT; PG.INT_ERE.ALL_GENO.END.GENO.BINARY[which(PG.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1
MG.INT_ERE.ALL_GENO.END.GENO.BINARY <- MG.INT_ERE.ALL_GENO.END.GENO.COUNT; MG.INT_ERE.ALL_GENO.END.GENO.BINARY[which(MG.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1
TH.INT_ERE.ALL_GENO.END.GENO.BINARY <- TH.INT_ERE.ALL_GENO.END.GENO.COUNT; TH.INT_ERE.ALL_GENO.END.GENO.BINARY[which(TH.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1
PH.INT_ERE.ALL_GENO.END.GENO.BINARY <- PH.INT_ERE.ALL_GENO.END.GENO.COUNT; PH.INT_ERE.ALL_GENO.END.GENO.BINARY[which(PH.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1
MH.INT_ERE.ALL_GENO.END.GENO.BINARY <- MH.INT_ERE.ALL_GENO.END.GENO.COUNT; MH.INT_ERE.ALL_GENO.END.GENO.BINARY[which(MH.INT_ERE.ALL_GENO.END.GENO.BINARY !=0)] <- 1


colfunc <- colorRampPalette(c("#A94E35","#FFFFFF","#383C6C"))

TEST <- PG.INT_ERE.ALL_GENO.END.GENO.BINARY - MG.INT_ERE.ALL_GENO.END.GENO.BINARY
X <- which(rowSums(PG.INT_ERE.ALL_GENO.END.GENO.BINARY) == 0 | rowSums(MG.INT_ERE.ALL_GENO.END.GENO.BINARY) == 0)
TEST <- TEST[-X,]
TEST2 <- melt(TEST)
ggplot(TEST2, aes(Var1, Var2))+geom_tile(aes(fill=value))+
  scale_fill_gradientn(colours=c("#A94E35","#FFFFFF","#383C6C"))+labs(x="",y="")+
  theme_classic()+coord_equal()+scale_x_discrete(position = "top") + theme(legend.position = "none",panel.grid = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
heatmap(t(TEST),cexRow=0.3,cexCol=0.2,col=c("#A94E35","#FFFFFF","#383C6C"),
        distfun= function(d) dist(d,method="binary"),
        hclustfun = function(h) hclust(h,method="complete"))



TEST <- log2(PG.INT_ERE.ALL_GENO.END.GENO.COUNT+1) - log2(MG.INT_ERE.ALL_GENO.END.GENO.COUNT+1)
X <- which(rowSums(PG.INT_ERE.ALL_GENO.END.GENO.COUNT) == 0 | rowSums(MG.INT_ERE.ALL_GENO.END.GENO.COUNT) == 0)
TEST <- TEST[-X,]
TEST2 <- melt(TEST)
#ggplot(TEST2, aes(Var1, Var2))+geom_tile(aes(fill=value))+
#  scale_fill_gradientn(colours=c("#A94E35","#FFFFFF","#383C6C"))+labs(x="",y="")+
#  theme_classic()+coord_equal()+scale_x_discrete(position = "top") + theme(legend.position = "none",panel.grid = element_blank(), axis.text.y = element_blank(), axis.ticks.y = element_blank())
heatmap(t(TEST),col=colfunc(20),cexRow=0.5,cexCol=0.2,
        distfun= function(d) dist(d,method="binary"),
        hclustfun = function(h) hclust(h,method="complete"))




###All starting genotypes collapsed
##Distribution of ending frequencies
TG.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(TG.ALL_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
TH.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(TH.ALL_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
PG.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(PG.ALL_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
PH.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(PH.ALL_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
MG.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(MG.ALL_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
MH.ALL_ERE.ALL_GENO.END.FREQ <- table(factor(MH.ALL_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))

TG.INT_ERE.ALL_GENO.END.FREQ <- table(factor(TG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
TH.INT_ERE.ALL_GENO.END.FREQ <- table(factor(TH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
PG.INT_ERE.ALL_GENO.END.FREQ <- table(factor(PG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
PH.INT_ERE.ALL_GENO.END.FREQ <- table(factor(PH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
MG.INT_ERE.ALL_GENO.END.FREQ <- table(factor(MG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
MH.INT_ERE.ALL_GENO.END.FREQ <- table(factor(MH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))

##Binary reached/not reached
TG.INT_ERE.ALL_GENO.END.FREQ/TG.INT_ERE.ALL_GENO.END.FREQ
PG.INT_ERE.ALL_GENO.END.FREQ/PG.INT_ERE.ALL_GENO.END.FREQ

##Difference in end frequency
##Only for common ERE genotypes
TG.PG.INT_ERE.ALL_GENO.DIFF <- table(factor(TG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) - table(factor(PG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
TG.MG.INT_ERE.ALL_GENO.DIFF <- table(factor(TG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) - table(factor(MG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
PG.MG.INT_ERE.ALL_GENO.DIFF <- table(factor(PG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) - table(factor(MG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST))))
TH.PH.INT_ERE.ALL_GENO.DIFF <- table(factor(TH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) - table(factor(PH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
TH.MH.INT_ERE.ALL_GENO.DIFF <- table(factor(TH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) - table(factor(MH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))
PH.MH.INT_ERE.ALL_GENO.DIFF <- table(factor(PH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) - table(factor(MH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST))))

##Remove ending genotypes which nothing reaches
TG.PG.INT_ERE.ALL_GENO.DIFF[which(table(factor(TG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0 & table(factor(PG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0)] <- NA
TG.MG.INT_ERE.ALL_GENO.DIFF[which(table(factor(TG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0 & table(factor(MG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0)] <- NA
PG.MG.INT_ERE.ALL_GENO.DIFF[which(table(factor(PG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0 & table(factor(MG.INT_ERE.ALL_GENO.END,levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) == 0)] <- NA
TH.PH.INT_ERE.ALL_GENO.DIFF[which(table(factor(TH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0 & table(factor(PH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0)] <- NA
TH.MH.INT_ERE.ALL_GENO.DIFF[which(table(factor(TH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0 & table(factor(MH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0)] <- NA
PH.MH.INT_ERE.ALL_GENO.DIFF[which(table(factor(PH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0 & table(factor(MH.INT_ERE.ALL_GENO.END,levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) == 0)] <- NA

par(mfrow=c(3,2))
hist(TG.PG.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="TG - PG End Count Diff.",main="")
hist(TH.PH.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="TH - PH End Count Diff.",main="")
hist(TG.MG.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="TG - MG End Count Diff.",main="")
hist(TH.MH.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="TH - MH End Count Diff.",main="")
hist(PG.MG.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="PG - MG End Count Diff.",main="")
hist(PH.MH.INT_ERE.ALL_GENO.DIFF,breaks=seq(-3000,2600,50),xlim=c(-1000,1000),xlab="PH - MH End Count Diff.",main="")

##Number of unique end genotypes
TG.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:97,FUN= function(x) {sum(table(factor(TG.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) != 0)})
PG.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:97,FUN= function(x) {sum(table(factor(PG.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) != 0)})
MG.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:97,FUN= function(x) {sum(table(factor(MG.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TG.SRE.LIST,PG.SRE.LIST,MG.SRE.LIST)))) != 0)})
TH.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:59,FUN= function(x) {sum(table(factor(TH.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) != 0)})
PH.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:59,FUN= function(x) {sum(table(factor(PH.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) != 0)})
MH.INT_ERE.ALL_GENO.END.COUNT <- sapply(1:59,FUN= function(x) {sum(table(factor(MH.INT_ERE.ALL_GENO.END[,x],levels=unique(c(TH.SRE.LIST,PH.SRE.LIST,MH.SRE.LIST)))) != 0)})

par(mfrow=c(3,2))
hist(TG.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="TG Number Unique End",main=""); abline(v=mean(TG.INT_ERE.ALL_GENO.END.COUNT),col="red")
hist(TH.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="TH Number Unique End",main=""); abline(v=mean(TH.INT_ERE.ALL_GENO.END.COUNT),col="red")
hist(PG.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="PG Number Unique End",main=""); abline(v=mean(PG.INT_ERE.ALL_GENO.END.COUNT),col="red")
hist(PH.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="PH Number Unique End",main=""); abline(v=mean(PH.INT_ERE.ALL_GENO.END.COUNT),col="red")
hist(MG.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="MG Number Unique End",main=""); abline(v=mean(MG.INT_ERE.ALL_GENO.END.COUNT),col="red")
hist(MH.INT_ERE.ALL_GENO.END.COUNT,xlim=c(100,300),breaks=seq(100,300,20),xlab="MH Number Unique End",main=""); abline(v=mean(MH.INT_ERE.ALL_GENO.END.COUNT),col="red")

PG.MG.INT_ERE.ALL_GENO.END.PERCENT <- (PG.INT_ERE.ALL_GENO.END.COUNT - MG.INT_ERE.ALL_GENO.END.COUNT)/(MG.INT_ERE.ALL_GENO.END.COUNT)
PG.MG.INT_ERE.ALL_GENO.END.PERCENT[order(PG.MG.INT_ERE.ALL_GENO.END.PERCENT)]

TG.PG.INT_ERE.ALL_GENO.END.PERCENT <- (TG.INT_ERE.ALL_GENO.END.COUNT - PG.INT_ERE.ALL_GENO.END.COUNT)/(PG.INT_ERE.ALL_GENO.END.COUNT)
TG.PG.INT_ERE.ALL_GENO.END.PERCENT[order(TG.PG.INT_ERE.ALL_GENO.END.PERCENT)]

##Collect set of observed end genotypes
I <- 1:97
END.COUNT.COR <- matrix(0,nrow=length(I),ncol=4)
for(i in I) {
  SET <- unique(c(names(table(factor(TG.INT_ERE.ALL_GENO.END[,i]))),names(table(factor(PG.INT_ERE.ALL_GENO.END[,i]))),names(table(factor(MG.INT_ERE.ALL_GENO.END[,i])))))
  SET <- SET[order(SET)]
  
  MG.INT_ERE.ALL_GENO.END.COUNT.COMBINED <- table(factor(MG.INT_ERE.ALL_GENO.END[,i],levels=SET))
  PG.INT_ERE.ALL_GENO.END.COUNT.COMBINED <- table(factor(PG.INT_ERE.ALL_GENO.END[,i],levels=SET))
  TG.INT_ERE.ALL_GENO.END.COUNT.COMBINED <- table(factor(TG.INT_ERE.ALL_GENO.END[,i],levels=SET))
  
  G.END.COUNT <- cbind("MG"=MG.INT_ERE.ALL_GENO.END.COUNT.COMBINED,"PG"=PG.INT_ERE.ALL_GENO.END.COUNT.COMBINED,"TG"=TG.INT_ERE.ALL_GENO.END.COUNT.COMBINED)
  par(mfrow=c(2,2))
  plot(G.END.COUNT[G.END.COUNT[,1]>0,1],                    G.END.COUNT[G.END.COUNT[,1]>0,2],                    xlab="MG End Freq",ylab="PG End Freq",pch=19,cex=0.6)
  plot(G.END.COUNT[G.END.COUNT[,1]>0 & G.END.COUNT[,2]>0,1],G.END.COUNT[G.END.COUNT[,1]>0 & G.END.COUNT[,2]>0,2],xlab="MG End Freq",ylab="PG End Freq",pch=19,cex=0.6)
  plot(G.END.COUNT[G.END.COUNT[,2]>0,2],                    G.END.COUNT[G.END.COUNT[,2]>0,3],                    xlab="PG End Freq",ylab="TG End Freq",pch=19,cex=0.6)
  plot(G.END.COUNT[G.END.COUNT[,2]>0 & G.END.COUNT[,3]>0,2],G.END.COUNT[G.END.COUNT[,2]>0 & G.END.COUNT[,3]>0,3],xlab="PG End Freq",ylab="TG End Freq",pch=19,cex=0.6)
  
  END.COUNT.COR[i,1] <- cor(G.END.COUNT[G.END.COUNT[,1]>0,1],G.END.COUNT[G.END.COUNT[,1]>0,2])
  END.COUNT.COR[i,2] <- cor(G.END.COUNT[G.END.COUNT[,2]>0,2],G.END.COUNT[G.END.COUNT[,2]>0,3])
  
  END.COUNT.COR[i,3] <- cor(G.END.COUNT[G.END.COUNT[,1]>0 & G.END.COUNT[,2]>0,1],G.END.COUNT[G.END.COUNT[,1]>0 & G.END.COUNT[,2]>0,2])
  END.COUNT.COR[i,4] <- cor(G.END.COUNT[G.END.COUNT[,2]>0 & G.END.COUNT[,3]>0,2],G.END.COUNT[G.END.COUNT[,2]>0 & G.END.COUNT[,3]>0,3])
}

par(mfrow=c(2,1))
plot(END.COUNT.COR[,1],END.COUNT.COR[,2],pch=19,cex=0.6,xlim=c(-.2,1),ylim=c(-.2,1),xlab="MG-PG End Count Freq Cor",ylab="PG-TG End Count Freq Cor")
abline(a=0,b=1)

plot(END.COUNT.COR[,3],END.COUNT.COR[,4],pch=19,cex=0.6,xlim=c(-.2,1),ylim=c(-.2,1),xlab="MG-PG End Count Freq Cor",ylab="PG-TG End Count Freq Cor")
abline(a=0,b=1)



###Genotype path identity
##Get path genotypes
TG.ALL_ERE.ALL_GENO.PATH <- TG.ALL_ERE.ALL_GENO.SIMULATE$Path
PG.ALL_ERE.ALL_GENO.PATH <- PG.ALL_ERE.ALL_GENO.SIMULATE$Path
MG.ALL_ERE.ALL_GENO.PATH <- MG.ALL_ERE.ALL_GENO.SIMULATE$Path
TH.ALL_ERE.ALL_GENO.PATH <- TH.ALL_ERE.ALL_GENO.SIMULATE$Path
PH.ALL_ERE.ALL_GENO.PATH <- PH.ALL_ERE.ALL_GENO.SIMULATE$Path
MH.ALL_ERE.ALL_GENO.PATH <- MH.ALL_ERE.ALL_GENO.SIMULATE$Path

##Get path geontypes for a common set of ERE starting poINT_ERE.ALL_GENOs
TG.INT_ERE.ALL_GENO.PATH <- TG.INT_ERE.ALL_GENO.SIMULATE$Path
PG.INT_ERE.ALL_GENO.PATH <- PG.INT_ERE.ALL_GENO.SIMULATE$Path
MG.INT_ERE.ALL_GENO.PATH <- MG.INT_ERE.ALL_GENO.SIMULATE$Path
TH.INT_ERE.ALL_GENO.PATH <- TH.INT_ERE.ALL_GENO.SIMULATE$Path
PH.INT_ERE.ALL_GENO.PATH <- PH.INT_ERE.ALL_GENO.SIMULATE$Path
MH.INT_ERE.ALL_GENO.PATH <- MH.INT_ERE.ALL_GENO.SIMULATE$Path


X <- which(PG.INT_ERE.ALL_GENO.END[,1]=="KAZC")
Y <- which(MG.INT_ERE.ALL_GENO.END[,1]=="KAZC")


PG.INT_ERE.ALL_GENO.PATH[[1]][X]
MG.INT_ERE.ALL_GENO.PATH[[1]][Y]

####################
##6. Network plots##
####################
##Network where a genotype is functional in at least one model
DT.JOINT.ALL.ACT <- subset(DT.JOINT,DT.JOINT$RE=="E" & (DT.JOINT$TE.JOINT.CLASS != "null" | DT.JOINT$PE.JOINT.CLASS != "null" | DT.JOINT$ME.JOINT.CLASS != "null"))
NODES.ALL.ACT <- data.frame(id=1:length(DT.JOINT.ALL.ACT$AAseq),label=substr(DT.JOINT.ALL.ACT$AAseq,2,5),stringsAsFactors = F)
NODES.ALL.ACT$TE <- DT.JOINT.ALL.ACT$TE.JOINT.CLASS
NODES.ALL.ACT$PE <- DT.JOINT.ALL.ACT$PE.JOINT.CLASS
NODES.ALL.ACT$ME <- DT.JOINT.ALL.ACT$ME.JOINT.CLASS
NODES.ALL.ACT$X1 <- DT.JOINT.ALL.ACT$AA1
NODES.ALL.ACT$X2 <- DT.JOINT.ALL.ACT$AA2
NODES.ALL.ACT$X3 <- DT.JOINT.ALL.ACT$AA3
NODES.ALL.ACT$X4 <- DT.JOINT.ALL.ACT$AA4
SOURCE.ALL.ACT <- vector()
TARGET.ALL.ACT <- vector()
I <- 1:nrow(NODES.ALL.ACT)
for(i in I) {
  J <- which(NODES.ALL.ACT$label %in% get.neighbors(NODES.ALL.ACT$label[i],code="Z"))
  for(j in J){
    SOURCE.ALL.ACT <- c(SOURCE.ALL.ACT, i)
    TARGET.ALL.ACT <- c(TARGET.ALL.ACT, j)
  }
}
EDGES.ALL.ACT <- data.frame(source=SOURCE.ALL.ACT, target=TARGET.ALL.ACT, stringsAsFactors = F)
#write.gexf(nodes=NODES.ALL.ACT[,1:2],nodesAtt=NODES.ALL.ACT[,3:9],edges=EDGES.ALL.ACT,output="ALL.ACT.gexf")


###Network where frequency of visit on a trajectory determines size
DT.JOINT.ALL.ACT <- subset(DT.JOINT,DT.JOINT$RE=="E" & (DT.JOINT$TE.JOINT.CLASS != "null" | DT.JOINT$PE.JOINT.CLASS != "null" | DT.JOINT$ME.JOINT.CLASS != "null"))
DT.JOINT.ALL.ACT.E <- subset(DT.JOINT,DT.JOINT$RE=="E" & (DT.JOINT$TE.JOINT.CLASS != "null" | DT.JOINT$PE.JOINT.CLASS != "null" | DT.JOINT$ME.JOINT.CLASS != "null"))
DT.JOINT.ALL.ACT.S <- subset(DT.JOINT,DT.JOINT$RE=="S" & (DT.JOINT$TE.JOINT.CLASS != "null" | DT.JOINT$PE.JOINT.CLASS != "null" | DT.JOINT$ME.JOINT.CLASS != "null"))

DT.JOINT.ALL.ACT$TE.JOINT.CLASS.ALT <- DT.JOINT.ALL.ACT$TE.JOINT.CLASS
DT.JOINT.ALL.ACT$TE.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.TE.CLASS == "strong" & DT.JOINT.ALL.ACT.S$PRED.TE.CLASS == "weak"  ] <- "ERE-specific"
DT.JOINT.ALL.ACT$TE.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.TE.CLASS == "weak"   & DT.JOINT.ALL.ACT.S$PRED.TE.CLASS == "strong"] <- "SRE-specific"

DT.JOINT.ALL.ACT$PE.JOINT.CLASS.ALT <- DT.JOINT.ALL.ACT$PE.JOINT.CLASS
DT.JOINT.ALL.ACT$PE.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.PE.CLASS == "strong" & DT.JOINT.ALL.ACT.S$PRED.PE.CLASS == "weak"  ] <- "ERE-specific"
DT.JOINT.ALL.ACT$PE.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.PE.CLASS == "weak"   & DT.JOINT.ALL.ACT.S$PRED.PE.CLASS == "strong"] <- "SRE-specific"

DT.JOINT.ALL.ACT$ME.JOINT.CLASS.ALT <- DT.JOINT.ALL.ACT$ME.JOINT.CLASS
DT.JOINT.ALL.ACT$ME.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.ME.CLASS == "strong" & DT.JOINT.ALL.ACT.S$PRED.ME.CLASS == "weak"  ] <- "ERE-specific"
DT.JOINT.ALL.ACT$ME.JOINT.CLASS.ALT[DT.JOINT.ALL.ACT.E$PRED.ME.CLASS == "weak"   & DT.JOINT.ALL.ACT.S$PRED.ME.CLASS == "strong"] <- "SRE-specific"

NODES.ALL.ACT <- data.frame(id=1:length(DT.JOINT.ALL.ACT$AAseq),label=substr(DT.JOINT.ALL.ACT$AAseq,2,5),stringsAsFactors = F)
NODES.ALL.ACT$TE <- DT.JOINT.ALL.ACT$TE.JOINT.CLASS
NODES.ALL.ACT$PE <- DT.JOINT.ALL.ACT$PE.JOINT.CLASS
NODES.ALL.ACT$ME <- DT.JOINT.ALL.ACT$ME.JOINT.CLASS
NODES.ALL.ACT$TE.ALT <- DT.JOINT.ALL.ACT$TE.JOINT.CLASS.ALT
NODES.ALL.ACT$PE.ALT <- DT.JOINT.ALL.ACT$PE.JOINT.CLASS.ALT
NODES.ALL.ACT$ME.ALT <- DT.JOINT.ALL.ACT$ME.JOINT.CLASS.ALT
NODES.ALL.ACT$X1 <- DT.JOINT.ALL.ACT$AA1
NODES.ALL.ACT$X2 <- DT.JOINT.ALL.ACT$AA2
NODES.ALL.ACT$X3 <- DT.JOINT.ALL.ACT$AA3
NODES.ALL.ACT$X4 <- DT.JOINT.ALL.ACT$AA4
NODES.ALL.ACT$TG.DGCC.PATHS <- c(table(factor(unlist(TG.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$PG.DGCC.PATHS <- c(table(factor(unlist(PG.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$MG.DGCC.PATHS <- c(table(factor(unlist(MG.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$TG.EGKS.PATHS <- c(table(factor(unlist(TG.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$PG.EGKS.PATHS <- c(table(factor(unlist(PG.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$MG.EGKS.PATHS <- c(table(factor(unlist(MG.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$TH.DGCC.PATHS <- c(table(factor(unlist(TH.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$PH.DGCC.PATHS <- c(table(factor(unlist(PH.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$MH.DGCC.PATHS <- c(table(factor(unlist(MH.INT.PATH[[1]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$TH.EGKS.PATHS <- c(table(factor(unlist(TH.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$PH.EGKS.PATHS <- c(table(factor(unlist(PH.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))
NODES.ALL.ACT$MH.EGKS.PATHS <- c(table(factor(unlist(MH.INT.PATH[[9]]),levels=NODES.ALL.ACT$label)))

SOURCE.ALL.ACT <- vector()
TARGET.ALL.ACT <- vector()
I <- 1:nrow(NODES.ALL.ACT)
for(i in I) {
  J <- which(NODES.ALL.ACT$label %in% get.neighbors(NODES.ALL.ACT$label[i],code="Z"))
  for(j in J){
    SOURCE.ALL.ACT <- c(SOURCE.ALL.ACT, i)
    TARGET.ALL.ACT <- c(TARGET.ALL.ACT, j)
  }
}
G.EDGES.ALL.ACT <- data.frame(source=SOURCE.ALL.ACT, target=TARGET.ALL.ACT, stringsAsFactors = F)
write.gexf(nodes=NODES.ALL.ACT[,1:2],nodesAtt=NODES.ALL.ACT[,3:24],edges=G.EDGES.ALL.ACT,output="G.ALL.ACT.gexf")


SOURCE.ALL.ACT <- vector()
TARGET.ALL.ACT <- vector()
I <- 1:nrow(NODES.ALL.ACT)
for(i in I) {
  J <- which(NODES.ALL.ACT$label %in% get.neighbors(NODES.ALL.ACT$label[i],code="S"))
  for(j in J){
    SOURCE.ALL.ACT <- c(SOURCE.ALL.ACT, i)
    TARGET.ALL.ACT <- c(TARGET.ALL.ACT, j)
  }
}
H.EDGES.ALL.ACT <- data.frame(source=SOURCE.ALL.ACT, target=TARGET.ALL.ACT, stringsAsFactors = F)
write.gexf(nodes=NODES.ALL.ACT[,1:2],nodesAtt=NODES.ALL.ACT[,3:24],edges=H.EDGES.ALL.ACT,output="H.ALL.ACT.gexf")








###Network where # of genotypes at site 1 determines node size
#DT.JOINT.ALL.ACT.X1 <- subset(DT.JOINT,DT.JOINT$RE=="E" & (DT.JOINT$TE.JOINT.CLASS != "null" | DT.JOINT$PE.JOINT.CLASS != "null" | DT.JOINT$ME.JOINT.CLASS != "null"))
#
#UNIQUE.X234 <- unique(paste0(DT.JOINT.ALL.ACT.X1$AA2,DT.JOINT.ALL.ACT.X1$AA3,DT.JOINT.ALL.ACT.X1$AA4))
#I <- 1:length(UNIQUE.X234)
#COUNT.MATRIX <- matrix(0,nrow=length(I),ncol=15)
#colnames(COUNT.MATRIX) <- c("TE.ERE","TE.SRE","TE.PRO","TE.NULL","TE.TOTAL","PE.ERE","PE.SRE","PE.PRO","PE.NULL","PE.TOTAL","ME.ERE","ME.SRE","ME.PRO","ME.NULL","ME.TOTAL")
#for(i in I) {
#  SUBSET <- subset(DT.JOINT.ALL.ACT.X1, substring(DT.JOINT.ALL.ACT.X1$AAseq,3,5) == UNIQUE.X234[i])
#  
#  COUNT.MATRIX[i,1] <- sum(SUBSET$TE.JOINT.CLASS == "ERE-specific")
#  COUNT.MATRIX[i,2] <- sum(SUBSET$TE.JOINT.CLASS == "SRE-specific")
#  COUNT.MATRIX[i,3] <- sum(SUBSET$TE.JOINT.CLASS == "promiscuous")
#  COUNT.MATRIX[i,4] <- sum(SUBSET$TE.JOINT.CLASS == "null")
#  COUNT.MATRIX[i,6] <- sum(SUBSET$PE.JOINT.CLASS == "ERE-specific")
#  COUNT.MATRIX[i,7] <- sum(SUBSET$PE.JOINT.CLASS == "SRE-specific")
#  COUNT.MATRIX[i,8] <- sum(SUBSET$PE.JOINT.CLASS == "promiscuous")
#  COUNT.MATRIX[i,9] <- sum(SUBSET$PE.JOINT.CLASS == "null")
#  COUNT.MATRIX[i,11]<- sum(SUBSET$ME.JOINT.CLASS == "ERE-specific")
#  COUNT.MATRIX[i,12]<- sum(SUBSET$ME.JOINT.CLASS == "SRE-specific")
#  COUNT.MATRIX[i,13]<- sum(SUBSET$ME.JOINT.CLASS == "promiscuous")
#  COUNT.MATRIX[i,14]<- sum(SUBSET$ME.JOINT.CLASS == "null")
#}
#COUNT.MATRIX[,5] <- rowSums(COUNT.MATRIX[,1:3])
#COUNT.MATRIX[,10]<- rowSums(COUNT.MATRIX[,6:8])
#COUNT.MATRIX[,15]<- rowSums(COUNT.MATRIX[,11:13])
#
#NODES.ALL.ACT.X1 <- data.frame(id=1:length(UNIQUE.X234),label=UNIQUE.X234,COUNT.MATRIX,TE.CLASS="null",PE.CLASS="null",ME.CLASS="null",stringsAsFactors = F)
#NODES.ALL.ACT.X1$TE.CLASS[which(NODES.ALL.ACT.X1$TE.ERE >= NODES.ALL.ACT.X1$TE.SRE & NODES.ALL.ACT.X1$TE.ERE >= NODES.ALL.ACT.X1$TE.PRO)] <- "ERE-specific"
#NODES.ALL.ACT.X1$TE.CLASS[which(NODES.ALL.ACT.X1$TE.SRE >= NODES.ALL.ACT.X1$TE.ERE & NODES.ALL.ACT.X1$TE.SRE >= NODES.ALL.ACT.X1$TE.PRO)] <- "SRE-specific"
#NODES.ALL.ACT.X1$TE.CLASS[which(NODES.ALL.ACT.X1$TE.PRO >= NODES.ALL.ACT.X1$TE.ERE & NODES.ALL.ACT.X1$TE.PRO >= NODES.ALL.ACT.X1$TE.SRE)] <- "promiscuous"
#NODES.ALL.ACT.X1$TE.CLASS[which(NODES.ALL.ACT.X1$TE.ERE == 0 & NODES.ALL.ACT.X1$TE.SRE == 0 & NODES.ALL.ACT.X1$TE.PRO == 0)] <- "null"
#NODES.ALL.ACT.X1$PE.CLASS[which(NODES.ALL.ACT.X1$PE.ERE >= NODES.ALL.ACT.X1$PE.SRE & NODES.ALL.ACT.X1$PE.ERE >= NODES.ALL.ACT.X1$PE.PRO)] <- "ERE-specific"
#NODES.ALL.ACT.X1$PE.CLASS[which(NODES.ALL.ACT.X1$PE.SRE >= NODES.ALL.ACT.X1$PE.ERE & NODES.ALL.ACT.X1$PE.SRE >= NODES.ALL.ACT.X1$PE.PRO)] <- "SRE-specific"
#NODES.ALL.ACT.X1$PE.CLASS[which(NODES.ALL.ACT.X1$PE.PRO >= NODES.ALL.ACT.X1$PE.ERE & NODES.ALL.ACT.X1$PE.PRO >= NODES.ALL.ACT.X1$PE.SRE)] <- "promiscuous"
#NODES.ALL.ACT.X1$PE.CLASS[which(NODES.ALL.ACT.X1$PE.ERE == 0 & NODES.ALL.ACT.X1$PE.SRE == 0 & NODES.ALL.ACT.X1$PE.PRO == 0)] <- "null"
#NODES.ALL.ACT.X1$ME.CLASS[which(NODES.ALL.ACT.X1$ME.ERE >= NODES.ALL.ACT.X1$ME.SRE & NODES.ALL.ACT.X1$ME.ERE >= NODES.ALL.ACT.X1$ME.PRO)] <- "ERE-specific"
#NODES.ALL.ACT.X1$ME.CLASS[which(NODES.ALL.ACT.X1$ME.SRE >= NODES.ALL.ACT.X1$ME.ERE & NODES.ALL.ACT.X1$ME.SRE >= NODES.ALL.ACT.X1$ME.PRO)] <- "SRE-specific"
#NODES.ALL.ACT.X1$ME.CLASS[which(NODES.ALL.ACT.X1$ME.PRO >= NODES.ALL.ACT.X1$ME.ERE & NODES.ALL.ACT.X1$ME.PRO >= NODES.ALL.ACT.X1$ME.SRE)] <- "promiscuous"
#NODES.ALL.ACT.X1$ME.CLASS[which(NODES.ALL.ACT.X1$ME.ERE == 0 & NODES.ALL.ACT.X1$ME.SRE == 0 & NODES.ALL.ACT.X1$ME.PRO == 0)] <- "null"
#NODES.ALL.ACT.X1$MAX.COUNT <- apply(NODES.ALL.ACT.X1[,c(7,12,17)],1,max)
#SOURCE.ALL.ACT.X1 <- vector()
#TARGET.ALL.ACT.X1 <- vector()
#I <- 1:nrow(NODES.ALL.ACT.X1)
#for(i in I) {
#  J <- which(NODES.ALL.ACT.X1$label %in% get.neighbors(NODES.ALL.ACT.X1$label[i],code="Z"))
#  for(j in J){
#    SOURCE.ALL.ACT.X1 <- c(SOURCE.ALL.ACT.X1, i)
#    TARGET.ALL.ACT.X1 <- c(TARGET.ALL.ACT.X1, j)
#  }
#}
#EDGES.ALL.ACT.X1 <- data.frame(source=SOURCE.ALL.ACT.X1, target=TARGET.ALL.ACT.X1, stringsAsFactors = F)
##write.gexf(nodes=NODES.ALL.ACT.X1[,1:2],nodesAtt=NODES.ALL.ACT.X1[,3:21],edges=EDGES.ALL.ACT.X1,output="ALL.ACT.X1.gexf")


#######################
##7. Causality Search##
#######################
##Collect properties
TG.PROPERTIES <- matrix(0,nrow=59,ncol= 9); rownames(TG.PROPERTIES) <- names(TG.INT_ERE.IND_GENO.STEPS.AVG[1:59]); colnames(TG.PROPERTIES) <- c("Evo.Dist","Dist","Nearest.Dist","Num.Paths","Distinct.Paths","Num.ERE","Num.PRO","Num.SRE","Num.Total")
PG.PROPERTIES <- matrix(0,nrow=59,ncol= 9); rownames(PG.PROPERTIES) <- names(PG.INT_ERE.IND_GENO.STEPS.AVG[1:59]); colnames(PG.PROPERTIES) <- c("Evo.Dist","Dist","Nearest.Dist","Num.Paths","Distinct.Paths","Num.ERE","Num.PRO","Num.SRE","Num.Total")
MG.PROPERTIES <- matrix(0,nrow=59,ncol= 9); rownames(TG.PROPERTIES) <- names(MG.INT_ERE.IND_GENO.STEPS.AVG[1:59]); colnames(MG.PROPERTIES) <- c("Evo.Dist","Dist","Nearest.Dist","Num.Paths","Distinct.Paths","Num.ERE","Num.PRO","Num.SRE","Num.Total")

#Evolutionary distance
TG.PROPERTIES[,1] <- TG.INT_ERE.IND_GENO.STEPS.AVG[1:59]
PG.PROPERTIES[,1] <- PG.INT_ERE.IND_GENO.STEPS.AVG[1:59]
MG.PROPERTIES[,1] <- MG.INT_ERE.IND_GENO.STEPS.AVG[1:59]

#Distance on network
TG.PROPERTIES[,2] <- apply(TG.ERE.SRE.DIST.INTERSECT,1,mean,na.rm=TRUE) 
PG.PROPERTIES[,2] <- apply(PG.ERE.SRE.DIST.INTERSECT,1,mean,na.rm=TRUE) 
MG.PROPERTIES[,2] <- apply(MG.ERE.SRE.DIST.INTERSECT,1,mean,na.rm=TRUE) 

#Distance to nearest
TG.PROPERTIES[,3] <- TG.ERE.SRE.MIN.DIST.INTERSECT
PG.PROPERTIES[,3] <- PG.ERE.SRE.MIN.DIST.INTERSECT
MG.PROPERTIES[,3] <- MG.ERE.SRE.MIN.DIST.INTERSECT

#Number of paths
TG.PROPERTIES[,4] <- apply(TG.NUM.PATHS[TG.ERE.INTERSECT[1:59],TG.SRE.INTERSECT],1,mean,na.rm=TRUE)
PG.PROPERTIES[,4] <- apply(PG.NUM.PATHS[PG.ERE.INTERSECT[1:59],PG.SRE.INTERSECT],1,mean,na.rm=TRUE)
MG.PROPERTIES[,4] <- apply(MG.NUM.PATHS[MG.ERE.INTERSECT[1:59],MG.SRE.INTERSECT],1,mean,na.rm=TRUE)

#Number of distinct paths
TG.PROPERTIES[,5] <- apply(TG.ERE.DISTINCT[TG.ERE.INTERSECT[1:59],TG.SRE.INTERSECT],1,mean,na.rm=TRUE)
PG.PROPERTIES[,5] <- apply(PG.ERE.DISTINCT[PG.ERE.INTERSECT[1:59],PG.SRE.INTERSECT],1,mean,na.rm=TRUE)
MG.PROPERTIES[,5] <- apply(MG.ERE.DISTINCT[MG.ERE.INTERSECT[1:59],MG.SRE.INTERSECT],1,mean,na.rm=TRUE)

#Neighbor class count
I <- 1:59
for(i in I) {
  NEIGHBORS <- unlist(TG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[1]][1])
  TG.PROPERTIES[i,6] <- sum(NEIGHBORS == "ERE-specific")
  TG.PROPERTIES[i,7] <- sum(NEIGHBORS == "promiscuous")
  TG.PROPERTIES[i,8] <- sum(NEIGHBORS == "SRE-specific")
  NEIGHBORS <- unlist(PG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[1]][1])
  PG.PROPERTIES[i,6] <- sum(NEIGHBORS == "ERE-specific")
  PG.PROPERTIES[i,7] <- sum(NEIGHBORS == "promiscuous")
  PG.PROPERTIES[i,8] <- sum(NEIGHBORS == "SRE-specific")
  NEIGHBORS <- unlist(MG.INT_ERE.ALL_GENO.SIMULATE$Neighbors.Class[[i]][[1]][1])
  MG.PROPERTIES[i,6] <- sum(NEIGHBORS == "ERE-specific")
  MG.PROPERTIES[i,7] <- sum(NEIGHBORS == "promiscuous")
  MG.PROPERTIES[i,8] <- sum(NEIGHBORS == "SRE-specific")
}
TG.PROPERTIES[i,9] <- TG.PROPERTIES[i,6] + TG.PROPERTIES[i,7] + TG.PROPERTIES[i,8]
PG.PROPERTIES[i,9] <- PG.PROPERTIES[i,6] + PG.PROPERTIES[i,7] + PG.PROPERTIES[i,8]
MG.PROPERTIES[i,9] <- MG.PROPERTIES[i,6] + MG.PROPERTIES[i,7] + MG.PROPERTIES[i,8]

#Calculate difference in properties
DIFF.PROPERTIES <- PG.PROPERTIES - MG.PROPERTIES
DIFF.PROPERTIES <- data.frame(DIFF.PROPERTIES)
DIFF.PROPERTIES.SCALED  <- t((t(DIFF.PROPERTIES ) - apply(DIFF.PROPERTIES ,2,mean))/apply(DIFF.PROPERTIES ,2,sd))
DIFF.PROPERTIES.SCALED  <- data.frame(DIFF.PROPERTIES.SCALED)

##Correlation and partial correlation
cor(DIFF.PROPERTIES.SCALED)
pcor(DIFF.PROPERTIES.SCALED)

#Partial correlation heatmap
DIFF.PROPERTIES.ESTIMATE <- pcor(DIFF.PROPERTIES.SCALED)$estimate
DIFF.PROPERTIES.ESTIMATE <- DIFF.PROPERTIES.ESTIMATE - diag(9)*DIFF.PROPERTIES.ESTIMATE
COLOR <- colorRampPalette(c("darkred","white","skyblue2"))   
heatmap.2(DIFF.PROPERTIES.ESTIMATE,Rowv=FALSE,Colv=FALSE,dendrogram='none',trace='none',col=COLOR(100))

##Linear model
MODEL <- lm(Evo.Dist ~ 0 + Nearest.Dist + Num.Paths + Distinct.Paths + Num.ERE + Num.PRO + Num.SRE + Num.Total, data=DIFF.PROPERTIES.SCALED)
step(MODEL,k=log(59))

MODEL2 <- lm(Evo.Dist ~ 0 + Num.ERE + Num.SRE, data=DIFF.PROPERTIES.SCALED)

par(mfrow=c(2,2))
plot(DIFF.PROPERTIES$Num.ERE,DIFF.PROPERTIES$Evo.Dist,pch=19,cex=0.6,xlab="change in Num ERE",ylab="Change in Evo Dist")
plot(DIFF.PROPERTIES$Num.SRE,DIFF.PROPERTIES$Evo.Dist,pch=19,cex=0.6,xlab="change in Num SRE",ylab="Change in Evo Dist")

